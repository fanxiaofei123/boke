<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="MainLineOrder" FormType="Entity">
    <DataSource RefObjectKey="LRP_TransportOrder"/>
    <Body>
        <Block>
            <GridLayoutPanel Key="root">
                <TableView Key="RouteName_table" X="0" Y="0">
                    <TableRowCollection>
                        <TableRow Key="r1" SeparatorStyle="solid none" SeparatorColor="#b8becc">
                            <LinearLayoutPanel Key="spec_sel_pa" Orientation="Horizontal" Height="50px" LeftPadding="10px">
                                <Image Key="spec_sel_a" Height="auto" Width="30px" Stretch="true" SourceType="Resource" Image="17.png" Margin="7px" ImageScaleType="Fit_Center"/>
                                <Label Key="Time_1" Caption="用车时间" Width="70px" Height="auto">
                                    <Format>
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <DatePicker Key="Time" Caption="现在" Width="180px" Weight="1.0" Height="auto">
                                    <DataBinding ColumnKey="ExpectArriveTime" TableKey="LRP_TransportOrder_H">
                                        <ValueChanged>
                                            <![CDATA[																							
													   var tt = Format(GetValue('Time'),'yyyy-MM-dd')&' 08:00:00';
													   SetValue('Time2',tt);
												]]>
                                        </ValueChanged>
                                    </DataBinding>
                                    <Format ForeColor="#f14c52" HAlign="Center">
                                        <Font Size="12"/>
                                    </Format>
                                </DatePicker>
                                <DatePicker Key="Time2" Caption="现在" Width="180px" Weight="1.0" Height="auto" Visible="False">
                                    <Format ForeColor="#f14c52" HAlign="Center">
                                        <Font Size="12"/>
                                    </Format>
                                </DatePicker>
                                <Button Key="spec_sel_m" Icon="more_arrow.png" OnlyIcon="True" Width="30px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r2" TopMargin="5px" SeparatorStyle="solid none" SeparatorColor="#b8becc">
                            <GridLayoutPanel Key="GridLayoutPanel1" Padding="5px" Caption="GridLayoutPanel1" Height="60px">
                                <Image Key="SendImage" Caption="SendImage" Height="auto" Width="30px" Stretch="true" SourceType="Resource" Image="10.png" Margin="5px" ImageScaleType="Fit_Center" X="0" Y="0" YSpan="2"/>
                                <Label Key="lbl_send" Caption="请输入始发地" Width="80px" Height="auto" Visible="SendOrgId == ''" X="1" Y="0" XSpan="2" YSpan="2">
                                    <Format HAlign="Left"/>
                                </Label>
                                <Label Key="SendOrgId" Width="80px" Height="auto" Visible="False" X="1" Y="0" XSpan="2">
                                    <DataBinding ColumnKey="SendPartyName" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendAddress" Width="80px" Height="auto" Visible="False" X="2" Y="0">
                                    <DataBinding ColumnKey="SendAddress" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendContact" Width="80px" Height="auto" X="1" Y="1">
                                    <DataBinding ColumnKey="SendContactor" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="Address1" Height="auto" X="1" Y="0" XSpan="2">
                                    <DataBinding DefaultFormulaValue="IIF(SendAddress=='',SendOrgId,SendOrgId&amp;'('&amp;SendAddress&amp;')')"/>
                                    <Format HAlign="Left">
                                        <Font Size="15"/>
                                    </Format>
                                </Label>
                                <Label Key="SendTel" Width="80px" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="SendContactTel" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendProvinceId" Caption="发货省" Width="80px" Visible="False" Height="auto" X="1" Y="1">
                                    <DataBinding ColumnKey="SendProvinceId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendCityId" Caption="发货市" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="SendCityId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendDistrictId" Caption="发货区县" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="SendDistrictId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendLongitude" Caption="发货地经度" Width="80px" Visible="False" Height="auto" X="1" Y="1">
                                    <DataBinding ColumnKey="SendLongitude" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="SendLatitude" Caption="发货地纬度" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="SendLatitude" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DispatchOrgId" Caption="调度组织" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="DispatchOrgId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Button Key="spec_sel1" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none" X="3" Y="0" YSpan="2">
                                    <Format BackColor="#ffffff"/>
                                </Button>
                                <RowDefCollection RowGap="1">
                                    <RowDef Height="30px"/>
                                    <RowDef Height="25px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="3">
                                    <ColumnDef Width="40px"/>
                                    <ColumnDef Width="50px"/>
                                    <ColumnDef Width="100%"/>
                                    <ColumnDef Width="20px"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <RowClick>
                                <![CDATA[
                                      Root.SetPara('grandfatherKey',GetFormKey());
									  Show('SendInformation');
								]]>
                            </RowClick>
                        </TableRow>
                        <TableRow Key="r3" TopMargin="5px" SeparatorStyle="none none solid none" SeparatorColor="#b8becc">
                            <GridLayoutPanel Key="GridLayoutPanel2" Padding="5px" Caption="GridLayoutPanel1" Height="60px">
                                <Image Key="DestImage" Caption="DestImage" Height="auto" Width="30px" Stretch="true" SourceType="Resource" Image="11.png" Margin="5px" ImageScaleType="Fit_Center" X="0" Y="0" YSpan="2"/>
                                <Label Key="lbl_dest" Caption="请输入目的地" Width="80px" Height="auto" Visible="DestOrgId == ''" X="1" Y="0" XSpan="2" YSpan="2">
                                    <Format HAlign="Left"/>
                                </Label>
                                <Label Key="DestOrgId" Width="80px" Height="auto" Visible="False" X="1" Y="0" XSpan="2">
                                    <DataBinding ColumnKey="RecvPartyName" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestAddress" Width="80px" Height="auto" Visible="False" X="2" Y="0">
                                    <DataBinding ColumnKey="RecvAddress" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestContact" Width="80px" Height="auto" X="1" Y="1">
                                    <DataBinding ColumnKey="RecvContactor" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="Address3" Height="auto" X="1" Y="0" XSpan="2">
                                    <DataBinding DefaultFormulaValue="IIF(DestAddress=='',DestOrgId,DestOrgId&amp;'('&amp;DestAddress&amp;')')"/>
                                    <Format HAlign="Left">
                                        <Font Size="15"/>
                                    </Format>
                                </Label>
                                <Label Key="DestTel" Width="80px" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="RecvContactTel" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestProvinceId" Caption="收货省" Width="80px" Visible="False" Height="auto" X="1" Y="1">
                                    <DataBinding ColumnKey="RecvProvinceId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestCityId" Caption="收货市" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="RecvCityId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestDistrictId" Caption="收货区县" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="RecvDistrictId" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestLongitude" Caption="收货地经度" Width="80px" Visible="False" Height="auto" X="1" Y="1">
                                    <DataBinding ColumnKey="RecvLongitude" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Label Key="DestLatitude" Caption="收货地纬度" Width="80px" Visible="False" Height="auto" X="2" Y="1">
                                    <DataBinding ColumnKey="RecvLatitude" TableKey="LRP_TransportOrder_H"/>
                                </Label>
                                <Button Key="spec_sel2" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none" X="3" Y="0" YSpan="2">
                                    <Format BackColor="#ffffff"/>
                                </Button>
                                <RowDefCollection RowGap="1">
                                    <RowDef Height="30px"/>
                                    <RowDef Height="25px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="3">
                                    <ColumnDef Width="40px"/>
                                    <ColumnDef Width="50px"/>
                                    <ColumnDef Width="100%"/>
                                    <ColumnDef Width="20px"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <RowClick>
                                <![CDATA[
								      PushPara('Type',0);
                                       var count = -1;
									   PushPara('rowcount',count);
									   PushPara('formkey','MainLineOrder');									  
									  Root.SetPara('grandfatherKey',GetFormKey());
										   Show('RecInformation');
									
								]]>
                            </RowClick>
                        </TableRow>
                        <TableRow Key="RowDetail" TopMargin="5px" SeparatorStyle="none none none none" RowType="Detail" SeparatorColor="#b8becc" TableKey="LRP_TransportMaterial_L">
                            <GridLayoutPanel Key="GridLayoutPanel5" Caption="GridLayoutPanel1" Height="40px">
                                <Label Key="LoadWeight" Caption="重量" Height="auto" Width="60px" X="1" Y="0"/>
                                <NumberEditor Key="spec_sel_LoadWeight" Caption="重量" Precision="5" Scale="1" Width="pref" Height="auto" X="2" Y="0" Enable="true">
                                    <DataBinding ColumnKey="Weight">
                                        <ValueChanged>
                                            <![CDATA[
												if(GetValue('SendOrgId') != "" && GetValue('DestOrgId') != ""){
											   InvokeService("LRP_LTLQuoteByTransportOrder",true,true);
											   }
												]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </NumberEditor>
                                <Label Key="LoadCubage" Caption="体积" Height="auto" Width="60px" X="3" Y="0"/>
                                <NumberEditor Key="spec_sel_LoadCubage" Caption="体积" Precision="5" Scale="1" Width="pref" Height="auto" X="4" Y="0" Enable="true">
                                    <DataBinding ColumnKey="Cubage">
                                        <ValueChanged>
                                            <![CDATA[
												if(GetValue('SendOrgId') != "" && GetValue('DestOrgId') != ""){
											   InvokeService("LRP_LTLQuoteByTransportOrder",true,true);
											   }
												]]>
                                        </ValueChanged>
                                    </DataBinding>
                                </NumberEditor>
                                <Label Key="Freight" Caption="运费" Height="auto" Width="60px" Visible="False" X="1" Y="0"/>
                                <NumberEditor Key="spec_sel_Freight" Precision="5" Scale="1" Visible="False" Width="pref" Height="auto" X="2" Y="0">
                                    <DataBinding ColumnKey="Freight"/>
                                </NumberEditor>
                                <Label Key="TransferFee" Caption="转运费" Height="auto" Width="60px" Visible="False" X="3" Y="0"/>
                                <NumberEditor Key="spec_sel_TransferFee" Precision="5" Scale="1" Visible="False" Width="pref" Height="auto" X="4" Y="0">
                                    <DataBinding ColumnKey="TransferFee"/>
                                </NumberEditor>
                                <Label Key="DeliveryFee" Caption="送货费" Height="auto" Width="60px" Visible="False" X="1" Y="0"/>
                                <NumberEditor Key="spec_sel_DeliveryFee" Precision="5" Scale="1" Visible="False" Width="pref" Height="auto" X="2" Y="0">
                                    <DataBinding ColumnKey="DeliveryFee"/>
                                </NumberEditor>
                                <RowDefCollection RowGap="1">
                                    <RowDef Height="40px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="3">
                                    <ColumnDef Width="10px"/>
                                    <ColumnDef Width="70px"/>
                                    <ColumnDef Width="50%"/>
                                    <ColumnDef Width="70px"/>
                                    <ColumnDef Width="50%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                        </TableRow>
                        <TableRow Key="r7" TopMargin="5px" SeparatorStyle="none none none none" SeparatorColor="#b8becc">
                            <GridLayoutPanel Key="spec_sel_pane11" Caption="spec_sel_pane11">
                                <LinearLayoutPanel Key="spec_sel_pane111" Orientation="Horizontal" X="1" Y="0">
                                    <Label Key="Mileage" Caption="里程" Width="70px" Height="auto"/>
                                    <NumberEditor Key="spec_sel_Mileage" Precision="5" Scale="1" Enable="false" Width="pref" Height="auto" BorderStyle="none">
                                        <DataBinding ColumnKey="Mileage" TableKey="LRP_TransportOrder_H"/>
                                        <Format BackColor="transparent"/>
                                    </NumberEditor>
                                    <Label Key="Mi" Caption="公里" Width="60px" Height="auto"/>
                                </LinearLayoutPanel>
                                <LinearLayoutPanel Key="spec_sel_pane112" Orientation="Horizontal" X="2" Y="0">
                                    <Label Key="MaterialTotalQty" Caption="货物总数量" Width="70px" Height="auto"/>
                                    <NumberEditor Key="spec_sel_MaterialTotalQty" Precision="5" Scale="1" Height="auto" Weight="1.0">
                                        <DataBinding ColumnKey="MaterialTotalQty" TableKey="LRP_TransportOrder_H"/>
                                        <Format BackColor="transparent"/>
                                    </NumberEditor>
                                </LinearLayoutPanel>
                                <RowDefCollection RowGap="1">
                                    <RowDef Height="40px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="3">
                                    <ColumnDef Width="10px"/>
                                    <ColumnDef Width="50%"/>
                                    <ColumnDef Width="50%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                        </TableRow>
                        <TableRow Key="r8" TopMargin="5px" SeparatorStyle="none none solid none" SeparatorColor="#b8becc">
                            <LinearLayoutPanel Key="spec_sel_pane12" Orientation="Horizontal" Height="38px" LeftPadding="10px">
                                <Label Key="Payment" Caption="运费支付方式" Width="100px" Height="auto"/>
                                <ComboBox Key="spec_sel_Payment" Caption="运费支付方式" Height="auto" Weight="1.0">
                                    <DataBinding ColumnKey="PayMethod" TableKey="LRP_TransportOrder_H" Required="true"/>
                                    <Item Caption="发货时付款" Key="3" Value="3"/>
                                    <Item Caption="收货时付款" Key="5" Value="5"/>
                                </ComboBox>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r88" TopMargin="5px" SeparatorStyle="none none solid none" SeparatorColor="#b8becc">
                            <LinearLayoutPanel Key="spec_sel_pane122" Orientation="Horizontal" Height="38px" LeftPadding="10px">
                                <Label Key="PayChannel" Caption="付款方式" Width="100px" Height="auto"/>
                                <ComboBox Key="spec_sel_PayChannel" Caption="付款方式" Height="auto" Weight="1.0">
                                    <DataBinding ColumnKey="PayChannel" TableKey="LRP_TransportOrder_H" Required="true"/>
                                    <Item Caption="微信" Key="wechat" Value="wechat"/>
                                    <Item Caption="支付宝" Key="alipay" Value="alipay"/>
                                    <Item Caption="余额" Key="amount" Value="amount"/>
                                    <Item Caption="现金" Key="cash" Value="cash"/>
                                    <Item Caption="转账" Key="transfer" Value="transfer"/>
                                    <Item Caption="票据" Key="voucher" Value="voucher"/>
                                    <Item Caption="网络支付" Key="internet" Value="internet"/>
                                </ComboBox>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r9" TopMargin="5px" SeparatorStyle="none none none none" SeparatorColor="#b8becc">
                            <LinearLayoutPanel Key="spec_sel_pane13" Orientation="Horizontal" Height="40px" LeftPadding="10px">
                                <Label Key="Remark" Caption="备注" Width="60px" Height="auto"/>
                                <TextEditor Key="spec_sel_Remark" Width="auto" Height="auto" BorderStyle="none">
                                    <DataBinding ColumnKey="Remark" TableKey="LRP_TransportOrder_H"/>
                                    <Format BackColor="transparent"/>
                                </TextEditor>
                                <Label Key="lbl_spec_sel_Remark" Width="0px" Weight="1.0" Height="auto"/>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r10" TopMargin="5px" SeparatorStyle="solid none" SeparatorColor="#b8becc">
                            <LinearLayoutPanel Key="spec_sel_pane14" Orientation="Horizontal" Height="40px" LeftPadding="10px">
                                <Image Key="spec_sel_Service" Height="auto" Width="30px" Stretch="true" SourceType="Resource" Image="18.png" Margin="7px" ImageScaleType="Fit_Center"/>
                                <Label Key="ExtraService" Caption="额外服务" Width="80px" Height="auto">
                                    <Format BackColor="transparent" ForeColor="#000000">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <Label Key="lbl_spec_sel_Service" Width="0px" Weight="1.0" Height="auto"/>
                                <Label Key="Serv" Caption="装卸、回单回款等服务" Width="pref" Height="auto" Margin="10px">
                                    <Format ForeColor="#f14c52">
                                        <Font Size="12"/>
                                    </Format>
                                </Label>
                                <Button Key="spec_ExtraService" Icon="more_arrow.png" OnlyIcon="True" Width="30px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                            <RowClick>
                                <![CDATA[
                                 Show("ExtraService");
								]]>
                            </RowClick>
                        </TableRow>
                    </TableRowCollection>
                </TableView>
                <GridLayoutPanel Key="GridLayoutPanel4" Padding="10px" LeftPadding="20px" RightPadding="20px" TopPadding="0px" X="0" Y="1" Caption="GridLayoutPanel1">
                    <Format BackColor="#ffffff"/>
                    <Label Key="j" X="0" Y="0" Height="auto">
                        <Format BackColor="#ffffff" ForeColor="#bbbbbb">
                            <Font Size="16"/>
                        </Format>
                    </Label>
                    <Label Key="jine" Caption="约￥" X="1" Y="0" Height="auto">
                        <Format BackColor="#ffffff" ForeColor="#f14c52" HAlign="Right">
                            <Font Size="16"/>
                        </Format>
                    </Label>
                    <NumberEditor Key="spec_sel_fee" X="2" Y="0" Precision="5" Scale="1" Enable="false" Width="auto" Height="auto">
                        <DataBinding DefaultFormulaValue="ToDecimal(GetCellValue('RowDetail',0,'spec_sel_Freight')) + ToDecimal(GetCellValue('RowDetail',0,'spec_sel_TransferFee')) + ToDecimal(GetCellValue('RowDetail',0,'spec_sel_DeliveryFee'))"/>
                        <Format BackColor="#ffffff" ForeColor="#f14c52" HAlign="Left">
                            <Font Size="16"/>
                        </Format>
                    </NumberEditor>
                    <Label Key="ji" X="3" Y="0" Height="auto">
                        <Format BackColor="#ffffff" ForeColor="#bbbbbb">
                            <Font Size="16"/>
                        </Format>
                    </Label>
                    <Label Key="des" Caption="实际费用可能因实际行驶里程/等候时间等因素而异" X="0" Y="1" Height="auto" BorderStyle="solid" BorderColor="Transparent" XSpan="4">
                        <Format BackColor="#ffffff" ForeColor="#bbbbbb" HAlign="Center">
                            <Font Size="12"/>
                        </Format>
                    </Label>
                    <RowDefCollection>
                        <RowDef Height="50px"/>
                        <RowDef Height="30px"/>
                        <RowDef Height="30px"/>
                    </RowDefCollection>
                    <ColumnDefCollection ColumnGap="3">
                        <ColumnDef Width="25%"/>
                        <ColumnDef Width="25%"/>
                        <ColumnDef Width="25%"/>
                        <ColumnDef Width="25%"/>
                    </ColumnDefCollection>
                </GridLayoutPanel>
                <LinearLayoutPanel Key="opt_pane2" X="0" Y="2" Orientation="Horizontal" BorderStyle="none">
                    <Format BackColor="#ffffff"/>
                    <Button Key="order" Caption="下单" Enable="True" Width="pref" Height="auto" Weight="1.0" BorderStyle="none">
                        <Format BackColor="#f14c52" ForeColor="#ffffff"/>
                        <OnClick>
                            <![CDATA[
								if(GetValue('Time') >= DateAdd(Format(ServerDate(),"yyyy-MM-dd HH:mm:ss"),"n",30)){
								 if(Format(GetValue('Time'),'EEEE') != "星期日"){
								    if(DateDiff(GetValue('Time2'),GetValue('Time'),"h") > 12 || DateDiff(GetValue('Time2'),GetValue('Time'),"h") < 0 || DateDiff(GetValue('Time2'),GetValue('Time'),"s") < 0 || DateDiff(GetValue('Time2'),GetValue('Time'),"s") > 43200){
									   ShowToast("星期一到星期六用车时间必须在早上8：00－晚上20：00");
									   return true;
									}
								}else{
									if(DateDiff(GetValue('Time2'),GetValue('Time'),"h") > 10 || DateDiff(GetValue('Time2'),GetValue('Time'),"h") < 0 || DateDiff(GetValue('Time2'),GetValue('Time'),"s") < 0 || DateDiff(GetValue('Time2'),GetValue('Time'),"s") > 36000){
									   ShowToast("星期日用车时间必须在早上8：00－晚上18：00");
										return true;
									}
								}
							}else{
								ShowToast("你选择的用车时间必须在当前时间半小时后");
								return true;
							}
							
							
							if(GetValue('SendOrgId') == ""){
							   ShowToast("请先输入始发地");
							   return true;
							}
							if(GetValue('DestOrgId') == ""){
							  ShowToast("请先输入目的地");
							  return true;
							}
							
							 PushPara('DestOrgId1',GetValue('DestOrgId'));
                            PushPara('Time1',GetValue('Time'));
                            PushPara('SendOrgId1',GetValue('SendOrgId'));
							PushPara('SendAddress1',GetValue('SendAddress'));
                            PushPara('SendContact1',GetValue('SendContact'));
							PushPara('SendTel1',GetValue('SendTel'));
							PushPara('spec_sel_fee1',GetValue('spec_sel_fee'));
                            
							PushPara('DestAddress1',GetValue('DestAddress'));
                            PushPara('DestContact1',GetValue('DestContact'));
							PushPara('DestTel1',GetValue('DestTel'));
							PushPara('OrderLoadWeight1',GetCellValue('RowDetail',0,'spec_sel_LoadWeight'));
							PushPara('spec_sel_LoadCubage1',GetCellValue('RowDetail',0,'spec_sel_LoadCubage'));
							PushPara('spec_sel_Mileage1',GetValue('spec_sel_Mileage'));
							PushPara('spec_sel_Payment1',GetValue('spec_sel_Payment'));
							PushPara('spec_sel_Remark1',GetValue('spec_sel_Remark'));
							PushPara('Serv1',GetValue('Serv'));
							PushPara('CarName1',GetPara('CarName'));
							PushPara('OrderType1',Para('OrderType'));
							var s = GetValue('Serv');
		                    var number = InvokeService("LRP_Serv",true,false,s);
							var oid = InvokeService("LRP_Generate_LTL",true,false,root.GetPara('UserDispatchOrg'),GetValue('spec_sel_fee'),number);
							ShowToast("下单成功");
							PushPara('CurrentOrderOID',oid);
                            Show('CurrentOrder');
							SendSignal('SessionChanged');
							]]>
                        </OnClick>
                    </Button>
                </LinearLayoutPanel>
                <RowDefCollection>
                    <RowDef Height="100%"/>
                    <RowDef Height="90px"/>
                    <RowDef Height="45px"/>
                </RowDefCollection>
                <ColumnDefCollection>
                    <ColumnDef Width="100%"/>
                </ColumnDefCollection>
            </GridLayoutPanel>
        </Block>
    </Body>
    <OnLoad>
        <![CDATA[ 
		  		   
           InsertRow('RowDetail');		  
           SetCellValue('RowDetail',0,'spec_sel_LoadWeight',0);	  
           SetCellValue('RowDetail',0,'spec_sel_LoadCubage',0);	
		    SetCellValue('RowDetail',0,'spec_sel_Freight',0);	  
           SetCellValue('RowDetail',0,'spec_sel_TransferFee',0);	
		    SetCellValue('RowDetail',0,'spec_sel_DeliveryFee',0);	  
           SetValue('spec_sel_Payment',3);
           SetValue('spec_sel_PayChannel',"wechat");		   
		   SetValue('Time',DateAdd(Format(ServerDate(),'yyyy-MM-dd HH:mm:ss'),'n',30),False);
		   var tt = Format(GetValue('Time'),'yyyy-MM-dd')&' 08:00:00';
		   SetValue('Time2',tt);
           SetValue('DispatchOrgId',root.GetPara('UserDispatchOrg'));	

           SetValue('spec_sel_fee',ToInt(spec_sel_Freight) + ToInt(spec_sel_TransferFee) + ToInt(spec_sel_DeliveryFee));		   
		]]>
    </OnLoad>
    <FormParaCollection>
        <FormPara Formula="Para('OID')" Key="OID" Type="Formula"/>
        <FormPara Formula="Para('CarName')" Key="CarName" Type="Formula"/>
        <FormPara Formula="Para('spec_sel_m')" Key="spec_sel_m" Type="Formula"/>
        <FormPara Formula="Para('Address2')" Key="Address2" Type="Formula"/>
        <FormPara Formula="Para('Contact')" Key="Contact" Type="Formula"/>
        <FormPara Formula="Para('Tel')" Key="Tel" Type="Formula"/>
    </FormParaCollection>
    <NavigationBar BackColor="#f14c52" Style="Custom">
        <BarItem Key="Centertitle" Caption="完善订单信息" Location="Center">
            <Label Key="TitleCenter" Caption="完善订单信息" Width="100%">
                <Format BackColor="#f14c52" ForeColor="#ffffff" HAlign="Center">
                    <Font Size="20"/>
                </Format>
            </Label>
        </BarItem>
    </NavigationBar>
</Form>
