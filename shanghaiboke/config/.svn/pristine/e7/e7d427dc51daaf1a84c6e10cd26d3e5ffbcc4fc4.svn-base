<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="CHCS_Replenishment_H" Caption="补货申请单" FormType="Entity" ViewKey="CHCS_Replenishment_HView">
    <DataSource RefObjectKey="CHCS_Replenishment_H"/>
    <OperationCollection>
        <Operation Key="WORKITEM" Caption="WORKITEM" Tag="WORKITEM"/>
        <Operation Key="BPM" Caption="BPM" Tag="BPM"/>
        <Operation Key="Save" Caption="保存" Visible="!ReadOnly()">
            <Action>
                <![CDATA[SaveData(); UpdateView();]]>
            </Action>
        </Operation>
        <Operation Key="New" Caption="新增" Visible="ReadOnly()">
            <Action>
                <![CDATA[New('CHCS_Replenishment_H', 'self');]]>
            </Action>
        </Operation>
        <Operation Key="Delete" Caption="删除" Visible="ReadOnly()">
            <Action>
                <![CDATA[DeleteData();UpdateView();Close();]]>
            </Action>
        </Operation>
        <Operation Key="Edit" Caption="修改" Visible="ReadOnly()">
            <Action>
                <![CDATA[Edit();]]>
            </Action>
        </Operation>
        <Operation Key="Cancel" Caption="取消" Visible="!ReadOnly()">
            <Action>
                <![CDATA[Cancel();]]>
            </Action>
        </Operation>
        <Operation Key="Put" Caption="生成调拨单" Visible="ReadOnly()">
            <Action>
                <![CDATA[Map('CHCS_Replenishment_H2CHCS_Transfer_H', 'CHCS_Transfer_H')]]>
            </Action>
        </Operation>
        <Operation Key="Close" Caption="关闭" Visible="ReadOnly()">
            <Action>
                <![CDATA[Close()]]>
            </Action>
        </Operation>
        <Operation Key="Export" Caption="导出" Visible="ReadOnly()">
            <Action>
                <![CDATA[UIExportExcel()]]>
            </Action>
        </Operation>
        <Operation Key="Print" Caption="打印补货申请单" Visible="ReadOnly()">
            <Action>
                <![CDATA[Print();]]>
            </Action>
        </Operation>
    </OperationCollection>
    <ScriptCollection>
        <Script Key="Load" Caption="载入" Range="Action" Verb="Load">
            <![CDATA[LoadData();]]>
        </Script>
    </ScriptCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="root" Caption="根面板">
                <ToolBar Key="ToolBar1" Height="pref" Caption="ToolBar1">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Key="main" Orientation="Vertical" Height="100%" Caption="主面板">
                    <GridLayoutPanel Key="first_head" Height="pref" Padding="5px" Caption="基本信息">
                        <TextEditor Key="NO" Caption="补货申请单号" BuddyKey="Lab_NO" X="1" Y="0" Enable="false" AsQuery="true">
                            <DataBinding ColumnKey="NO" TableKey="CHCS_Replenishment_H"/>
                        </TextEditor>
                        <Label Key="Lab_NO" Caption="补货申请单号" X="0" Y="0"/>
                        <DatePicker Key="BillDate" Caption="申请日期" BuddyKey="Lab_BillDate" X="4" Y="0" Enable="false" OnlyDate="true">
                            <DataBinding DefaultFormulaValue="ServerDate()" ColumnKey="BillDate" TableKey="CHCS_Replenishment_H"/>
                        </DatePicker>
                        <Label Key="Lab_BillDate" Caption="申请日期" X="3" Y="0"/>
                        <DatePicker Key="Approval_Date" Caption="审批日期" BuddyKey="Lab_Approval_Date" X="7" Y="0" Enable="false" OnlyDate="true">
                            <DataBinding DefaultFormulaValue="ServerDate()" ColumnKey="Approval_Date" TableKey="CHCS_Replenishment_H"/>
                        </DatePicker>
                        <Label Key="Lab_Approval_Date" Caption="审批日期" X="6" Y="0"/>
                        <Dict Key="Applicant" Caption="申请人" BuddyKey="Lab_Applicant" X="1" Y="1" ItemKey="CHCS_Employee">
                            <DataBinding ColumnKey="Applicant" TableKey="CHCS_Replenishment_H"/>
                        </Dict>
                        <Label Key="Lab_Applicant" Caption="申请人" X="0" Y="1"/>
                        <Dict Key="Approver" Caption="审批人" BuddyKey="Lab_Approver" X="4" Y="1" ItemKey="CHCS_Employee">
                            <DataBinding ColumnKey="Approver" TableKey="CHCS_Replenishment_H"/>
                        </Dict>
                        <Label Key="Lab_Approver" Caption="审批人" X="3" Y="1"/>
                        <Dict Key="Vendor" Caption="航食公司" BuddyKey="Lab_Vendor" X="7" Y="1" ItemKey="CompanyCode">
                            <DataBinding ColumnKey="Vendor" TableKey="CHCS_Replenishment_H"/>
                        </Dict>
                        <Label Key="Lab_Vendor" Caption="航食公司" X="6" Y="1"/>
                        <ComboBox Key="Status" Caption="申请单状态" BuddyKey="Lab_Status" X="1" Y="2" SourceType="Status" Enable="false">
                            <DataBinding ColumnKey="Status" TableKey="CHCS_Replenishment_H" DefaultValue="100"/>
                        </ComboBox>
                        <Label Key="Lab_Status" Caption="申请单状态" X="0" Y="2"/>
                        <RowDefCollection RowHeight="30" RowGap="6">
                            <RowDef/>
                            <RowDef/>
                            <RowDef/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="20">
                            <ColumnDef Width="113px"/>
                            <ColumnDef Width="33%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="113px"/>
                            <ColumnDef Width="33%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="94px"/>
                            <ColumnDef Width="33%"/>
                            <ColumnDef Width="55px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                    <TabPanel Caption="TabPanel1" Key="TabPanel1">
                        <Grid Key="Grid2" Caption="补货申请单明细">
                            <GridColumnCollection>
                                <GridColumn Key="Tableware_Name" Caption="餐具名称" Width="80px"/>
                                <GridColumn Key="Standard_Stock" Caption="标准库存数量" Width="154px"/>
                                <GridColumn Key="Extant_Number" Caption="现存数量" Width="127px"/>
                                <GridColumn Key="Applications_Number" Caption="申请数量" Width="113px"/>
                                <GridColumn Key="Actual_Approvals_Number" Caption="实际批准数量" Width="166px"/>
                                <GridColumn Key="Unit" Caption="单位" Width="128px"/>
                                <GridColumn Key="IsUrgency" Caption="紧急程度" Width="129px"/>
                                <GridColumn Key="Remark" Caption="备注" Width="80px"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" TableKey="CHCS_Replenishment_L">
                                    <GridCell Key="Tableware_Name" Caption="餐具名称" CellType="Dict" ItemKey="CHCS_Product">
                                        <DataBinding ColumnKey="Tableware_Name"/>
                                        <ItemFilter>
                                            <Filter Query="select oid from CHCS_Product where Type=(select oid from LRP_Lookup_L where code='CPLX-CJ')" Type="DataSet"/>
                                        </ItemFilter>
                                    </GridCell>
                                    <GridCell Key="Standard_Stock" Caption="标准库存数量" CellType="NumberEditor" IntegerValue="true" Format="">
                                        <DataBinding ColumnKey="Standard_Stock"/>
                                    </GridCell>
                                    <GridCell Key="Extant_Number" Caption="现存数量" CellType="NumberEditor" IntegerValue="true" Format="">
                                        <DataBinding ColumnKey="Extant_Number"/>
                                    </GridCell>
                                    <GridCell Key="Applications_Number" Caption="申请数量" CellType="NumberEditor" IntegerValue="true" Format="">
                                        <DataBinding DefaultFormulaValue="Standard_Stock-Extant_Number" ColumnKey="Applications_Number"/>
                                    </GridCell>
                                    <GridCell Key="Actual_Approvals_Number" Caption="实际批准数量" CellType="NumberEditor" IntegerValue="true" Format="">
                                        <DataBinding ColumnKey="Actual_Approvals_Number"/>
                                    </GridCell>
                                    <GridCell Key="Unit" Caption="单位" CellType="Dict" ItemKey="LRP_Lookup_L">
                                        <DataBinding ColumnKey="Unit"/>
                                        <ItemFilter>
                                            <Filter Query="select oid  from LRP_Lookup_L where HeadCode='DW'" Type="DataSet"/>
                                        </ItemFilter>
                                    </GridCell>
                                    <GridCell Key="IsUrgency" Caption="紧急程度" CellType="ComboBox" IntegerValue="true">
                                        <DataBinding ColumnKey="IsUrgency"/>
                                        <Item Caption="一般" Key="0" Value="0"/>
                                        <Item Caption="紧急" Key="1" Value="1"/>
                                    </GridCell>
                                    <GridCell Key="Remark" Caption="备注" CellType="TextEditor">
                                        <DataBinding ColumnKey="Remark"/>
                                    </GridCell>
                                </GridRow>
                                <GridRow Key="row2" RowType="Total">
                                    <GridCell Key="cell35" Caption="合计"/>
                                    <GridCell Key="cell36">
                                        <DataBinding DefaultFormulaValue="Sum('Standard_Stock')"/>
                                    </GridCell>
                                    <GridCell Key="cell37">
                                        <DataBinding DefaultFormulaValue="Sum('Extant_Number')"/>
                                    </GridCell>
                                    <GridCell Key="cell38">
                                        <DataBinding DefaultFormulaValue="Sum('Applications_Number')"/>
                                    </GridCell>
                                    <GridCell Key="cell39">
                                        <DataBinding DefaultFormulaValue="Sum('Actual_Approvals_Number')"/>
                                    </GridCell>
                                    <GridCell Key="cell40"/>
                                    <GridCell Key="cell41"/>
                                    <GridCell Key="cell42"/>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                    </TabPanel>
                    <SplitSize Size="30%"/>
                    <SplitSize Size="70%"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
</Form>
