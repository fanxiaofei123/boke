<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="V_LTLQuote" Caption="零担和干线报价" FormType="Entity" ViewKey="V_LTLQuoteView">
    <DataSource RefObjectKey="LRP_LTLQuote"/>
    <OperationCollection>
        <Operation Caption="新增" Key="New" Visible="ReadOnly()">
            <Action>
                <![CDATA[
				New('V_LTLQuote');
			]]>
            </Action>
        </Operation>
        <Operation Caption="复制新增" Key="CopyNew" RefKey="CopyNew" ShortCuts="Ctrl+E"/>
        <Operation Caption="保存" Key="Save" ShortCuts="Ctrl+S" Visible="!ReadOnly()&amp;&amp;Status==100">
            <Action>
                <![CDATA[
				if(DispatchOrgId<=0){		
					Confirm('调度组织不可为空','OK','OK:{}');
					return true;
				}
				
				if(EffectiveDate > ExpireDate){		
					Confirm('生效日期不能晚于失效日期','OK','OK:{}');
					return true;
				}			
				
				SaveData();
				UpdateView();
			]]>
            </Action>
        </Operation>
        <Operation Caption="编辑" Key="Edit" RefKey="Edit" ShortCuts="Ctrl+E"/>
        <Operation Caption="删除" Key="Delete" RefKey="Delete" ShortCuts="Ctrl+D"/>
        <Operation Caption="取消" Key="Cancel" RefKey="Cancel"/>
        <Operation Key="Confirm" Caption="确认" Visible="ReadOnly()" RefKey="Confirm"/>
        <Operation Key="Confirm-R" Caption="撤销确认" Visible="ReadOnly();" RefKey="Confirm-R"/>
        <Operation Key="ToCancel" Caption="作废" Visible="ReadOnly()" RefKey="ToCancel"/>
        <Operation Key="ToCancel-R" Caption="撤销作废" Visible="ReadOnly()" RefKey="ToCancel-R"/>
        <Operation Caption="关闭界面" Key="Close" RefKey="Close"/>
    </OperationCollection>
    <ScriptCollection>
        <Script Key="Load" Caption="载入" Range="Action" Verb="Load">
            <![CDATA[LoadData();]]>
        </Script>
    </ScriptCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="root" Caption="根面板">
                <ToolBar Key="main_toolbar" Height="pref">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Key="main" Orientation="Vertical" Height="100%" Caption="主面板">
                    <TabPanel Caption="TabPanel1" Key="TabPanel1">
                        <GridLayoutPanel Key="BasicTab" Padding="10px" Caption="基本信息" BottomPadding="5px">
                            <TextEditor Key="No" Caption="报价单号" BuddyKey="Lab_No" X="1" Y="0" Enable="false" AsQuery="true">
                                <DataBinding ColumnKey="No" TableKey="LRP_LTLQuote_H"/>
                            </TextEditor>
                            <Label Key="Lab_No" Caption="报价单号" X="0" Y="0"/>
                            <TextEditor Key="Remark" Caption="备注" BuddyKey="Lab_Remark" X="1" Y="4" XSpan="7" AsQuery="true">
                                <DataBinding ColumnKey="Remark" TableKey="LRP_LTLQuote_H"/>
                            </TextEditor>
                            <Label Key="Lab_Remark" Caption="备注" X="0" Y="4"/>
                            <ComboBox Key="Status" Caption="状态" BuddyKey="Lab_Status" X="7" Y="3" SourceType="Status" Enable="false" AsQuery="true">
                                <DataBinding ColumnKey="Status" TableKey="LRP_LTLQuote_H" DefaultValue="100" Required="true"/>
                            </ComboBox>
                            <Label Key="Lab_Status" Caption="状态" X="6" Y="3"/>
                            <Dict Key="DispatchOrgId" Caption="调度组织" BuddyKey="Lab_DispatchOrgId" X="4" Y="0" ItemKey="LRP_DispatchOrg" AsQuery="true">
                                <DataBinding ColumnKey="DispatchOrgId" TableKey="LRP_LTLQuote_H" Required="true"/>
                            </Dict>
                            <Label Key="Lab_DispatchOrgId" Caption="调度组织" X="3" Y="0"/>
                            <ComboBox Key="DeliveryFeeBasis" Caption="送货费计算依据" BuddyKey="Lab_DeliveryFeeBasis" X="7" Y="0" AsQuery="true">
                                <DataBinding ColumnKey="DeliveryFeeBasis" TableKey="LRP_LTLQuote_H" Required="true"/>
                                <Item Caption="体积" Key="1" Value="1"/>
                                <Item Caption="重量" Key="2" Value="2"/>
                            </ComboBox>
                            <Label Key="Lab_DeliveryFeeBasis" Caption="送货费计算依据" X="6" Y="0"/>
                            <Dict Key="StartProvinceId" Caption="起运省" BuddyKey="Lab_StartProvinceId" X="1" Y="1" ItemKey="LRP_Province" AsQuery="true">
                                <DataBinding ColumnKey="StartProvinceId" TableKey="LRP_LTLQuote_H" Required="true"/>
                            </Dict>
                            <Label Key="Lab_StartProvinceId" Caption="起运省" X="0" Y="1"/>
                            <Dict Key="StartCityId" Caption="起运城市" BuddyKey="Lab_StartCityId" X="4" Y="1" ItemKey="LRP_City" AsQuery="true">
                                <DataBinding ColumnKey="StartCityId" TableKey="LRP_LTLQuote_H" Required="true"/>
                                <ItemFilter ItemKey="LRP_City">
                                    <Filter Type="FieldValue">
                                        <FilterValue FieldKey="ProvinceId" RefValue="StartProvinceId" Type="Field"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Label Key="Lab_StartCityId" Caption="起运城市" X="3" Y="1"/>
                            <ComboBox Key="TransferFeeBasis" Caption="转运费计算依据" BuddyKey="Lab_TransferFeeBasis" X="7" Y="1" AsQuery="true">
                                <DataBinding ColumnKey="TransferFeeBasis" TableKey="LRP_LTLQuote_H" Required="true"/>
                                <Item Caption="体积" Key="1" Value="1"/>
                                <Item Caption="重量" Key="2" Value="2"/>
                            </ComboBox>
                            <Label Key="Lab_TransferFeeBasis" Caption="转运费计算依据" X="6" Y="1"/>
                            <Dict Key="EndProvinceId" Caption="目的省" BuddyKey="Lab_EndProvinceId" X="1" Y="2" ItemKey="LRP_Province" AsQuery="true">
                                <DataBinding ColumnKey="EndProvinceId" TableKey="LRP_LTLQuote_H" Required="true"/>
                            </Dict>
                            <Label Key="Lab_EndProvinceId" Caption="目的省" X="0" Y="2"/>
                            <Dict Key="EndCityId" Caption="目的城市" BuddyKey="Lab_EndCityId" X="4" Y="2" ItemKey="LRP_City" AsQuery="true">
                                <DataBinding ColumnKey="EndCityId" TableKey="LRP_LTLQuote_H" Required="true"/>
                                <ItemFilter ItemKey="LRP_City">
                                    <Filter Type="FieldValue">
                                        <FilterValue FieldKey="ProvinceId" RefValue="EndProvinceId" Type="Field"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Label Key="Lab_EndCityId" Caption="目的城市" X="3" Y="2"/>
                            <Dict Key="EndDistrictId" Caption="目的区县" BuddyKey="Lab_EndDistrictId" X="7" Y="2" AllowMultiSelection="true" ItemKey="LRP_District" AsQuery="true">
                                <DataBinding ColumnKey="EndDistrictId" TableKey="LRP_LTLQuote_H" Required="true">
                                    <ValueChanged>
                                        <![CDATA[SetValue('EndDistrictName', GetText('EndDistrictId'));]]>
                                    </ValueChanged>
                                </DataBinding>
                                <ItemFilter ItemKey="LRP_District">
                                    <Filter Type="FieldValue">
                                        <FilterValue FieldKey="SOID" RefValue="EndCityId" Type="Field"/>
                                    </Filter>
                                </ItemFilter>
                            </Dict>
                            <Label Key="Lab_EndDistrictId" Caption="目的区县" X="6" Y="2"/>
                            <DatePicker Key="EffectiveDate" Caption="生效日期" BuddyKey="Lab_EffectiveDate" X="1" Y="3" OnlyDate="true" AsQuery="true">
                                <DataBinding ColumnKey="EffectiveDate" TableKey="LRP_LTLQuote_H" Required="true"/>
                                <Format/>
                            </DatePicker>
                            <Label Key="Lab_EffectiveDate" Caption="生效日期" X="0" Y="3"/>
                            <DatePicker Key="ExpireDate" Caption="截止日期" BuddyKey="Lab_ExpireDate" X="4" Y="3" OnlyDate="true" AsQuery="true">
                                <DataBinding ColumnKey="ExpireDate" TableKey="LRP_LTLQuote_H" Required="true"/>
                            </DatePicker>
                            <Label Key="Lab_ExpireDate" Caption="截止日期" X="3" Y="3"/>
                            <TextEditor Key="EndDistrictName" Caption="目的区县" X="8" Y="2" Visible="false">
                                <DataBinding ColumnKey="EndDistrictName" TableKey="LRP_LTLQuote_H"/>
                            </TextEditor>
                            <RowDefCollection RowGap="5">
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="5">
                                <ColumnDef Width="77px"/>
                                <ColumnDef Width="33%" MinWidth="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="77px"/>
                                <ColumnDef Width="33%" MinWidth="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%" MinWidth="55px"/>
                                <ColumnDef Width="55px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <GridLayoutPanel Key="SystemInfo" Padding="10px" Caption="系统信息">
                            <Dict Key="CREATOR" Caption="创建人" BuddyKey="Lab_CREATOR" X="1" Y="0" Enable="false" ItemKey="Operator">
                                <DataBinding ColumnKey="CREATOR" DefaultFormulaValue="GetOperator()" TableKey="LRP_LTLQuote_H"/>
                            </Dict>
                            <Label Key="Lab_CREATOR" Caption="创建人" X="0" Y="0"/>
                            <DatePicker Key="CREATETIME" Caption="创建时间" BuddyKey="Lab_CREATETIME" X="4" Y="0" Enable="false">
                                <DataBinding ColumnKey="CREATETIME" DefaultFormulaValue="ServerDate()" TableKey="LRP_LTLQuote_H"/>
                            </DatePicker>
                            <Label Key="Lab_CREATETIME" Caption="创建时间" X="3" Y="0"/>
                            <Dict Key="MODIFIER" Caption="修改人" BuddyKey="Lab_MODIFIER" X="1" Y="1" Enable="false" ItemKey="Operator">
                                <DataBinding ColumnKey="MODIFIER" DefaultFormulaValue="GetOperator()" TableKey="LRP_LTLQuote_H"/>
                            </Dict>
                            <Label Key="Lab_MODIFIER" Caption="修改人" X="0" Y="1"/>
                            <DatePicker Key="MODIFYTIME" Caption="修改时间" BuddyKey="Lab_MODIFYTIME" X="4" Y="1" Enable="false">
                                <DataBinding ColumnKey="MODIFYTIME" DefaultFormulaValue="ServerDate()" TableKey="LRP_LTLQuote_H"/>
                            </DatePicker>
                            <Label Key="Lab_MODIFYTIME" Caption="修改时间" X="3" Y="1"/>
                            <RowDefCollection RowGap="5">
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="5">
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                    </TabPanel>
                    <TabPanel Height="100%" Key="DetailTab" Padding="5px" TopPadding="5px">
                        <Grid Key="Grid0" Caption="按体积计算运费明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="column1" Caption="选择" Width="80px"/>
                                <GridColumn Key="LowerNumber" Caption="下限" Width="94px"/>
                                <GridColumn Key="UpperNumber" Caption="上限" Width="88px"/>
                                <GridColumn Key="PriceType" Caption="单价/总价" Width="80px"/>
                                <GridColumn Key="Price" Caption="价格" Width="84px"/>
                                <GridColumn Key="AddPrice" Caption="附加金额" Width="111px"/>
                                <GridColumn Key="MinPrice" Caption="最低金额" Width="97px"/>
                                <GridColumn Key="MaxPrice" Caption="最高金额" Width="96px"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="SEQUENCE" RowHeight="35" TableKey="LRP_LTLQuoteCubage_L">
                                    <GridCell Key="select" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                    <GridCell Key="LowerNumber" Caption="下限" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="LowerNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改下限后更新上一行的上限
																	var i = GetFocusRow('Grid0');
																	if(GetRowIndex('Grid0')==i){
																		if (i <= 0) {
																			//第一行不做考虑
																			return 1;
																		} else {
																			var qty = GetCellValue('Grid0', -1, 'LowerNumber');
																			SetCellValue('Grid0', i - 1, 'UpperNumber', qty);
																		}
																	}
																	]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="UpperNumber" Caption="上限" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="UpperNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改上限后更新下一行的上限
																var i = GetFocusRow('Grid0');
																var count = GetRowCount('Grid0', false);
																if(GetRowIndex('Grid0')==i){
																	if (i < count - 1) {   
																		var qty = GetCellValue('Grid0', -1, 'UpperNumber');  
																		SetCellValue('Grid0', i + 1, 'LowerNumber', qty);
																	}
																	if(i > 0){
																		if(GetCellValue('Grid0', -1, 'LowerNumber')<>GetCellValue('Grid0', i-1, 'UpperNumber')){
																			SetCellValue('Grid0', -1, 'LowerNumber', GetCellValue('Grid0', i-1, 'UpperNumber'));
																		}
																	}
																}
																]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="PriceType" Caption="单价/总价" CellType="ComboBox">
                                        <DataBinding ColumnKey="PriceType" DefaultValue="1" Required="true"/>
                                        <Item Caption="单价" Key="1" Value="1"/>
                                        <Item Caption="总价" Key="2" Value="2"/>
                                        <Item Caption="单价（扣减下限）" Key="3" Value="3"/>
                                    </GridCell>
                                    <GridCell Key="Price" Caption="价格" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="Price"/>
                                    </GridCell>
                                    <GridCell Key="AddPrice" Caption="附加金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="AddPrice"/>
                                    </GridCell>
                                    <GridCell Key="MinPrice" Caption="最低金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MinPrice"/>
                                    </GridCell>
                                    <GridCell Key="MaxPrice" Caption="最高金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MaxPrice"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid1" Caption="零担和干线报价运费按重量明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="column1" Caption="选择" Width="80px"/>
                                <GridColumn Key="LowerNumber" Caption="下限" Width="94px"/>
                                <GridColumn Key="UpperNumber" Caption="上限" Width="88px"/>
                                <GridColumn Key="PriceType" Caption="单价/总价" Width="80px"/>
                                <GridColumn Key="Price" Caption="价格" Width="84px"/>
                                <GridColumn Key="AddPrice" Caption="附加金额" Width="111px"/>
                                <GridColumn Key="MinPrice" Caption="最低金额" Width="97px"/>
                                <GridColumn Key="MaxPrice" Caption="最高金额" Width="96px"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="SEQUENCE" RowHeight="35" TableKey="LRP_LTLQuoteWeight_L">
                                    <GridCell Key="select1" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                    <GridCell Key="LowerNumber1" Caption="下限" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="LowerNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改下限后更新上一行的上限
																	var i = GetFocusRow('Grid1');
																	if(GetRowIndex('Grid1')==i){
																		if (i <= 0) {
																			//第一行不做考虑
																			return 1;
																		} else {
																			var qty = GetCellValue('Grid1', -1, 'LowerNumber1');
																			SetCellValue('Grid1', i - 1, 'UpperNumber1', qty);
																		}
																	}
																	]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="UpperNumber1" Caption="上限" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="UpperNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改上限后更新下一行的上限
																var i = GetFocusRow('Grid1');
																var count = GetRowCount('Grid1', false);
																if(GetRowIndex('Grid1')==i){
																	if (i < count - 1) {   
																		var qty = GetCellValue('Grid1', -1, 'UpperNumber1');  
																		SetCellValue('Grid1', i + 1, 'LowerNumber1', qty);
																	}
																	if(i > 0){
																		if(GetCellValue('Grid1', -1, 'LowerNumber1')<>GetCellValue('Grid1', i-1, 'UpperNumber1')){
																			SetCellValue('Grid1', -1, 'LowerNumber1', GetCellValue('Grid1', i-1, 'UpperNumber1'));
																		}
																	}
																}
																]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="PriceType1" Caption="单价/总价" CellType="ComboBox">
                                        <DataBinding ColumnKey="PriceType" DefaultValue="1" Required="true"/>
                                        <Item Caption="单价" Key="1" Value="1"/>
                                        <Item Caption="总价" Key="2" Value="2"/>
                                        <Item Caption="单价（扣减下限）" Key="3" Value="3"/>
                                    </GridCell>
                                    <GridCell Key="Price1" Caption="价格" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="Price"/>
                                    </GridCell>
                                    <GridCell Key="AddPrice1" Caption="附加金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="AddPrice"/>
                                    </GridCell>
                                    <GridCell Key="MinPrice1" Caption="最低金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MinPrice"/>
                                    </GridCell>
                                    <GridCell Key="MaxPrice1" Caption="最高金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MaxPrice"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid2" Caption="零担和干线报价送货费明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="column1" Caption="选择" Width="80px"/>
                                <GridColumn Key="LowerNumber" Caption="下限" Width="94px"/>
                                <GridColumn Key="UpperNumber" Caption="上限" Width="88px"/>
                                <GridColumn Key="PriceType" Caption="单价/总价" Width="80px"/>
                                <GridColumn Key="Price" Caption="价格" Width="84px"/>
                                <GridColumn Key="AddPrice" Caption="附加金额" Width="111px"/>
                                <GridColumn Key="MinPrice" Caption="最低金额" Width="97px"/>
                                <GridColumn Key="MaxPrice" Caption="最高金额" Width="96px"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="SEQUENCE" RowHeight="35" TableKey="LRP_LTLQuoteDeliveryFee_L">
                                    <GridCell Key="select2" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                    <GridCell Key="LowerNumber2" Caption="下限" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="LowerNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改下限后更新上一行的上限
																	var i = GetFocusRow('Grid2');
																	if(GetRowIndex('Grid2')==i){
																		if (i <= 0) {
																			//第一行不做考虑
																			return 1;
																		} else {
																			var qty = GetCellValue('Grid2', -1, 'LowerNumber2');
																			SetCellValue('Grid2', i - 1, 'UpperNumber2', qty);
																		}
																	}
																	]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="UpperNumber2" Caption="上限" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="UpperNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改上限后更新下一行的上限
																var i = GetFocusRow('Grid2');
																var count = GetRowCount('Grid2', false);
																if(GetRowIndex('Grid2')==i){
																	if (i < count - 1) {   
																		var qty = GetCellValue('Grid2', -1, 'UpperNumber2');  
																		SetCellValue('Grid2', i + 1, 'LowerNumber2', qty);
																	}
																	if(i > 0){
																		if(GetCellValue('Grid2', -1, 'LowerNumber2')<>GetCellValue('Grid2', i-1, 'UpperNumber2')){
																			SetCellValue('Grid2', -1, 'LowerNumber2', GetCellValue('Grid2', i-1, 'UpperNumber2'));
																		}
																	}
																}
																]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="PriceType2" Caption="单价/总价" CellType="ComboBox">
                                        <DataBinding ColumnKey="PriceType" DefaultValue="1" Required="true"/>
                                        <Item Caption="单价" Key="1" Value="1"/>
                                        <Item Caption="总价" Key="2" Value="2"/>
                                        <Item Caption="单价（扣减下限）" Key="3" Value="3"/>
                                    </GridCell>
                                    <GridCell Key="Price2" Caption="价格" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="Price"/>
                                    </GridCell>
                                    <GridCell Key="AddPrice2" Caption="附加金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="AddPrice"/>
                                    </GridCell>
                                    <GridCell Key="MinPrice2" Caption="最低金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MinPrice"/>
                                    </GridCell>
                                    <GridCell Key="MaxPrice2" Caption="最高金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MaxPrice"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid3" Caption="零担和干线报价转运费明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="column1" Caption="选择" Width="80px"/>
                                <GridColumn Key="LowerNumber" Caption="下限" Width="94px"/>
                                <GridColumn Key="UpperNumber" Caption="上限" Width="88px"/>
                                <GridColumn Key="PriceType" Caption="单价/总价" Width="80px"/>
                                <GridColumn Key="Price" Caption="价格" Width="84px"/>
                                <GridColumn Key="AddPrice" Caption="附加金额" Width="111px"/>
                                <GridColumn Key="MinPrice" Caption="最低金额" Width="97px"/>
                                <GridColumn Key="MaxPrice" Caption="最高金额" Width="96px"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="SEQUENCE" RowHeight="35" TableKey="LRP_LTLQuoteTransferFee_L">
                                    <GridCell Key="select3" Caption="选择" CellType="CheckBox" IsSelect="true"/>
                                    <GridCell Key="LowerNumber3" Caption="下限" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="LowerNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改下限后更新上一行的上限
																	var i = GetFocusRow('Grid3');
																	if(GetRowIndex('Grid3')==i){
																		if (i <= 0) {
																			//第一行不做考虑
																			return 1;
																		} else {
																			var qty = GetCellValue('Grid3', -1, 'LowerNumber3');
																			SetCellValue('Grid3', i - 1, 'UpperNumber3', qty);
																		}
																	}
																	]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="UpperNumber3" Caption="上限" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="UpperNumber">
                                            <ValueChanged>
                                                <![CDATA[//修改上限后更新下一行的上限
																var i = GetFocusRow('Grid3');
																var count = GetRowCount('Grid3', false);
																if(GetRowIndex('Grid3')==i){
																	if (i < count - 1) {   
																		var qty = GetCellValue('Grid3', -1, 'UpperNumber3');  
																		SetCellValue('Grid3', i + 1, 'LowerNumber3', qty);
																	}
																	if(i > 0){
																		if(GetCellValue('Grid3', -1, 'LowerNumber3')<>GetCellValue('Grid3', i-1, 'UpperNumber3')){
																			SetCellValue('Grid3', -1, 'LowerNumber3', GetCellValue('Grid3', i-1, 'UpperNumber3'));
																		}
																	}
																}
																]]>
                                            </ValueChanged>
                                        </DataBinding>
                                    </GridCell>
                                    <GridCell Key="PriceType3" Caption="单价/总价" CellType="ComboBox">
                                        <DataBinding ColumnKey="PriceType" DefaultValue="1" Required="true"/>
                                        <Item Caption="单价" Key="1" Value="1"/>
                                        <Item Caption="总价" Key="2" Value="2"/>
                                        <Item Caption="单价（扣减下限）" Key="3" Value="3"/>
                                    </GridCell>
                                    <GridCell Key="Price3" Caption="价格" CellType="NumberEditor" Precision="15" Scale="3" ShowZero="true">
                                        <DataBinding ColumnKey="Price"/>
                                    </GridCell>
                                    <GridCell Key="AddPrice3" Caption="附加金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="AddPrice"/>
                                    </GridCell>
                                    <GridCell Key="MinPrice3" Caption="最低金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MinPrice"/>
                                    </GridCell>
                                    <GridCell Key="MaxPrice3" Caption="最高金额" CellType="NumberEditor" Precision="15" Scale="3">
                                        <DataBinding ColumnKey="MaxPrice"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                    </TabPanel>
                    <SplitSize Size="220px"/>
                    <SplitSize Size="100%"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
</Form>
