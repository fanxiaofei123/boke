<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="V_NoticePickStategy" Caption="订单拣货策略" FormType="Entity">
    <DataSource RefObjectKey="LRP_NoticePickStrategy"/>
    <OperationCollection>
        <Operation Key="Save" Caption="保存" Visible="!ReadOnly()">
            <Action>
                <![CDATA[
if(GetRowCount('Grid3', false)>0){ 
if(StrategyType == '0'){
	if((GetCellValue('Grid3', 0, 'ObjectAttrib_03') != 'Q.RecvDate') || (GetCellValue('Grid3', 0, 'AscDesc_03') != 'ASC')){
		Confirm(LocaleString('STshow','stkey2'),'OK','OK:{}');
		return true;
	}
}
if(StrategyType == '1'){
	if((GetCellValue('Grid3', 0, 'ObjectAttrib_03') != 'Q.RecvDate') || (GetCellValue('Grid3', 0, 'AscDesc_03') != 'DESC')){
		Confirm(LocaleString('STshow','stkey3'),'OK','OK:{}');
		return true;
	}
}
if(StrategyType == '2'){
	if((GetCellValue('Grid3', 0, 'ObjectAttrib_03') != 'Q.BatchNo') || (GetCellValue('Grid3', 0, 'AscDesc_03') != 'ASC')){
		Confirm(LocaleString('STshow','stkey4'),'OK','OK:{}');
		return true;
	}
}
if(StrategyType == '4'){
	if((GetCellValue('Grid3', 0, 'ObjectAttrib_03') != 'Q.ExpireDate') || (GetCellValue('Grid3', 0, 'AscDesc_03') != 'DESC')){
		Confirm(LocaleString('STshow','stkey5'),'OK','OK:{}');
		return true;
	}
}
}
if(MatchWhereSql_Save()&&QuantWhereSql_Save()&&QuantSortSql_Save()&&PackQuantWhereSql_Save()&&PackQuantSortSql_Save()&&ShipLocWhereSql_Save()&&ShipLocSortSql_Save()){
    SaveData(); UpdateView();
}							
                                ]]>
            </Action>
        </Operation>
        <Operation Key="Edit" Caption="编辑" RefKey="Edit" ShortCuts="Ctrl+E"/>
        <Operation Key="Confirm" Caption="确认" RefKey="Confirm"/>
        <Operation Key="Confirm-R" Caption="撤销确认" Enable="ReadOnly()&amp;&amp;Status==StatusValue('confirmed')">
            <Action>
                <![CDATA[//查询选中的波次拣货策略是否被物料引用
var count=DBNamedQueryValue("SMaStrategy",GetOID());
if(count!=0){
	Confirm(LocaleString('STshow','stkey6'),'OK','OK{}');
	return true;
}
Status=StatusValue('prepared');SaveData();UpdateView();

]]>
            </Action>
        </Operation>
        <Operation Key="Delete" Caption="删除" RefKey="Delete" ShortCuts="Ctrl+D"/>
        <Operation Key="Cancel" Caption="取消" RefKey="Cancel"/>
        <Operation Key="ToCancel" Caption="作废" RefKey="ToCancel"/>
        <Operation Key="ToCancel-R" Caption="撤销作废" RefKey="ToCancel-R"/>
        <Operation Key="Close" Caption="关闭界面" RefKey="Close"/>
    </OperationCollection>
    <ScriptCollection>
        <Script Key="Load" Caption="载入" Range="Action" Verb="Load">
            <![CDATA[LoadData();]]>
        </Script>
    </ScriptCollection>
    <QueryCollection>
        <Query Key="SMaStrategy">
            <Statement>
                <![CDATA[select count(*) as count from LRP_MaterialStrategy where StrategyId= ?]]>
            </Statement>
        </Query>
    </QueryCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="root" Caption="根面板">
                <ToolBar Key="ToolBar1" Height="pref" Caption="ToolBar1">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Key="main" Orientation="Vertical" Height="100%" Caption="主面板">
                    <TabPanel Caption="TabPanel1" Key="TabPanel1">
                        <GridLayoutPanel Key="first_head" Height="pref" Padding="10px" Caption="基本信息">
                            <TextEditor Key="No" Caption="订单拣货策略号" BuddyKey="Lab_No" X="2" Y="0" Enable="false">
                                <DataBinding ColumnKey="No" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_No" Caption="订单拣货策略号" X="0" Y="0" XSpan="2"/>
                            <TextEditor Key="Name" Caption="策略名称" BuddyKey="Lab_Name" X="5" Y="0" Enable="!ReadOnly()">
                                <DataBinding ColumnKey="Name" TableKey="LRP_NoticePickStrategy_H" Required="true"/>
                            </TextEditor>
                            <Label Key="Lab_Name" Caption="策略名称" X="4" Y="0"/>
                            <ComboBox Key="StrategyType" Caption="策略类型" BuddyKey="Lab_StrategyType" X="8" Y="0" Enable="!ReadOnly()">
                                <DataBinding ColumnKey="StrategyType" TableKey="LRP_NoticePickStrategy_H" Required="true">
                                    <ValueChanging>
                                        <![CDATA[  	
												 Confirm(LocaleString('STshow','stkey7'),
												'YES_NO',  {YES:    
												 {       
												ClearAllRows('Grid4');
												ClearAllRows('Grid5');   
												CommitValue('StrategyType');  
												},         
												 NO:{RollbackValue('StrategyType');}});  
										]]>
                                    </ValueChanging>
                                    <ValueValidation>
                                        <![CDATA[GetValue('StrategyType') == 5 || (GetRowCount('Grid4')<=1 && GetRowCount('Grid5')<=1 )]]>
                                    </ValueValidation>
                                </DataBinding>
                                <Item Caption="先进先出" Key="StrategyType0" Value="0"/>
                                <Item Caption="后进先出" Key="StrategyType1" Value="1"/>
                                <Item Caption="批号早先出" Key="StrategyType2" Value="2"/>
                                <Item Caption="固定储位" Key="StrategyType3" Value="3"/>
                                <Item Caption="近效期先出" Key="StrategyType4" Value="4"/>
                                <Item Caption="整零分开" Key="StrategyType5" Value="5"/>
                                <Item Caption="自定义" Key="StrategyType6" Value="6"/>
                            </ComboBox>
                            <Label Key="Lab_StrategyType" Caption="策略类型" X="7" Y="0"/>
                            <ComboBox Key="Status" Caption="状态" BuddyKey="Lab_Status" X="8" Y="1" Enable="false">
                                <DataBinding ColumnKey="Status" TableKey="LRP_NoticePickStrategy_H" DefaultValue="100"/>
                                <Item Caption="已输入" Key="prepared" Value="100"/>
                                <Item Caption="已确认" Key="confirmed" Value="200"/>
                                <Item Caption="已作废" Key="cancelled" Value="20"/>
                            </ComboBox>
                            <Label Key="Lab_Status" Caption="状态" X="7" Y="1"/>
                            <TextEditor Key="Remarks" Caption="备注" BuddyKey="Lab_Remarks" X="2" Y="2" Enable="!ReadOnly()" XSpan="4">
                                <DataBinding ColumnKey="Remarks" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_Remarks" Caption="备注" X="0" Y="2" XSpan="2"/>
                            <Dict Key="WarehouseCenterId" Caption="仓储中心" BuddyKey="Lab_WarehouseCenterId" X="8" Y="2" Visible="false" ItemKey="LRP_WarehouseCenter">
                                <DataBinding ColumnKey="WarehouseCenterId" DefaultFormulaValue="getCurOrgID()" TableKey="LRP_NoticePickStrategy_H"/>
                            </Dict>
                            <Label Key="Lab_WarehouseCenterId" Caption="仓储中心" X="7" Y="2"/>
                            <NumberEditor Key="NearExpiredDays" Caption="近效期天数" BuddyKey="Lab_NearExpiredDays" Scale="0" X="2" Y="1">
                                <DataBinding ColumnKey="NearExpiredDays" TableKey="LRP_NoticePickStrategy_H"/>
                            </NumberEditor>
                            <Label Key="Lab_NearExpiredDays" Caption="近效期天数" X="0" Y="1" XSpan="2"/>
                            <RowDefCollection RowGap="8">
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="8">
                                <ColumnDef Width="77px"/>
                                <ColumnDef Width="15px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <GridLayoutPanel Key="GridLayoutPanel1" Padding="10px" Caption="检查SQL">
                            <TextEditor Key="MatchCheckSql" Caption="匹配条件检查SQL" BuddyKey="Lab_MatchCheckSql" X="1" Y="0" Enable="false" XSpan="7">
                                <DataBinding ColumnKey="MatchCheckSql" TableKey="LRP_NoticePickStrategy_H" DefaultValue="select H.OID from LRP_OutboundNotice_H H join LRP_OutboundNotice_L L on H.SOID = L.SOID join LRP_Material M on L.MaterialId = M.OID"/>
                            </TextEditor>
                            <Label Key="Lab_MatchCheckSql" Caption="匹配条件检查SQL" X="0" Y="0"/>
                            <TextEditor Key="MatchWhereSql" Caption="匹配条件SQL" BuddyKey="Lab_MatchWhereSql" X="1" Y="1" Enable="false" XSpan="7">
                                <DataBinding ColumnKey="MatchWhereSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_MatchWhereSql" Caption="匹配条件SQL" X="0" Y="1"/>
                            <TextEditor Key="QuantCheckSql" Caption="库存检查SQL" BuddyKey="Lab_QuantCheckSql" X="1" Y="2" Enable="false" XSpan="7">
                                <DataBinding ColumnKey="QuantCheckSql" TableKey="LRP_NoticePickStrategy_H" DefaultValue="select Q.OID from LRP_Quant Q join LRP_Location L on Q.LocationId = L.OID join LRP_Storearea A on L.StoreareaId = A.OID join LRP_Storeroom R on L.StoreroomId = R.OID join LRP_LocType T on L.LocTypeId = T.OID"/>
                            </TextEditor>
                            <Label Key="Lab_QuantCheckSql" Caption="库存检查SQL" X="0" Y="2"/>
                            <TextEditor Key="QuantWhereSql" Caption="库存匹配SQL" BuddyKey="Lab_QuantWhereSql" X="1" Y="3" Enable="false" XSpan="4">
                                <DataBinding ColumnKey="QuantWhereSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_QuantWhereSql" Caption="库存匹配SQL" X="0" Y="3"/>
                            <TextEditor Key="QuantSortSql" Caption="排序SQL" BuddyKey="Lab_QuantSortSql" X="7" Y="3" Enable="false">
                                <DataBinding ColumnKey="QuantSortSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_QuantSortSql" Caption="排序SQL" X="6" Y="3"/>
                            <TextEditor Key="PackQuantWhereSql" Caption="整件库存匹配SQL" BuddyKey="Lab_PackQuantWhereSql" X="1" Y="4" Enable="false" XSpan="4">
                                <DataBinding ColumnKey="PackQuantWhereSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_PackQuantWhereSql" Caption="整件库存匹配SQL" X="0" Y="4"/>
                            <TextEditor Key="PackQuantSortSql" Caption="排序SQL" BuddyKey="Lab_PackQuantSortSql" X="7" Y="4" Enable="false">
                                <DataBinding ColumnKey="PackQuantSortSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_PackQuantSortSql" Caption="排序SQL" X="6" Y="4"/>
                            <TextEditor Key="ShipLocCheckSql" Caption="发货区检查SQL" BuddyKey="Lab_ShipLocCheckSql" X="1" Y="5" Enable="false" XSpan="7">
                                <DataBinding ColumnKey="ShipLocCheckSql" TableKey="LRP_NoticePickStrategy_H" DefaultValue="select L.OID from LRP_Location L join LRP_Storearea A on L.StoreareaId = A.OID join LRP_Storeroom R on L.StoreroomId = R.OID join LRP_LocType T on L.LocTypeId = T.OID"/>
                            </TextEditor>
                            <Label Key="Lab_ShipLocCheckSql" Caption="发货区检查SQL" X="0" Y="5"/>
                            <TextEditor Key="ShipLocWhereSql" Caption="发货区匹配SQL" BuddyKey="Lab_ShipLocWhereSql" X="1" Y="6" Enable="false" XSpan="4">
                                <DataBinding ColumnKey="ShipLocWhereSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_ShipLocWhereSql" Caption="发货区匹配SQL" X="0" Y="6"/>
                            <TextEditor Key="ShipLocSortSql" Caption="发货区排序SQL" BuddyKey="Lab_ShipLocSortSql" X="7" Y="6" Enable="false">
                                <DataBinding ColumnKey="ShipLocSortSql" TableKey="LRP_NoticePickStrategy_H"/>
                            </TextEditor>
                            <Label Key="Lab_ShipLocSortSql" Caption="排序SQL" X="6" Y="6"/>
                            <RowDefCollection RowGap="8">
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="8">
                                <ColumnDef Width="99px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                                <ColumnDef Width="77px"/>
                                <ColumnDef Width="33%"/>
                                <ColumnDef Width="55px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <GridLayoutPanel Key="second_head" Height="pref" Padding="10px" Caption="系统信息">
                            <Dict Key="CREATOR" Caption="创建人" BuddyKey="Lab_CREATOR" X="1" Y="0" ItemKey="Operator">
                                <DataBinding ColumnKey="CREATOR" DefaultFormulaValue="GetOperator();" TableKey="LRP_NoticePickStrategy_H"/>
                            </Dict>
                            <Label Key="Lab_CREATOR" Caption="创建人" X="0" Y="0"/>
                            <DatePicker Key="CREATETIME" Caption="创建时间" BuddyKey="Lab_CREATETIME" X="3" Y="0">
                                <DataBinding ColumnKey="CREATETIME" DefaultFormulaValue="ServerDate();" TableKey="LRP_NoticePickStrategy_H"/>
                            </DatePicker>
                            <Label Key="Lab_CREATETIME" Caption="创建时间" X="2" Y="0"/>
                            <Dict Key="MODIFIER" Caption="修改人" BuddyKey="Lab_MODIFIER" X="1" Y="1" ItemKey="Operator">
                                <DataBinding ColumnKey="MODIFIER" DefaultFormulaValue="GetOperator();" TableKey="LRP_NoticePickStrategy_H"/>
                            </Dict>
                            <Label Key="Lab_MODIFIER" Caption="修改人" X="0" Y="1"/>
                            <DatePicker Key="MODIFYTIME" Caption="修改时间" BuddyKey="Lab_MODIFYTIME" X="3" Y="1">
                                <DataBinding ColumnKey="MODIFYTIME" DefaultFormulaValue="ServerDate();" TableKey="LRP_NoticePickStrategy_H"/>
                            </DatePicker>
                            <Label Key="Lab_MODIFYTIME" Caption="修改日期" X="2" Y="1"/>
                            <RowDefCollection RowGap="8">
                                <RowDef Height="30px"/>
                                <RowDef Height="30px"/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="8">
                                <ColumnDef Width="80px"/>
                                <ColumnDef Width="50%"/>
                                <ColumnDef Width="80px"/>
                                <ColumnDef Width="50%"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                    </TabPanel>
                    <TabPanel Height="100%" Key="DetailTab">
                        <Grid Key="Grid1" Caption="条件匹配明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="LeftBrackets" Caption="左括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="ObjectAttrib" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="Operator" Caption="操作符" Width="80px" Sortable="true"/>
                                <GridColumn Key="Value" Caption="值" Width="80px" Sortable="true"/>
                                <GridColumn Key="RightBrackets" Caption="右括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="LogicalOperator" Caption="逻辑运算符" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_CM_L">
                                    <GridCell Key="LeftBrackets" Caption="左括号" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="LeftBrackets"/>
                                        <Item Caption="(" Key="ParenthesesLeft1" Value="("/>
                                        <Item Caption="((" Key="ParenthesesLeft2" Value="(("/>
                                        <Item Caption="(((" Key="ParenthesesLeft3" Value="((("/>
                                    </GridCell>
                                    <GridCell Key="ObjectAttrib" Caption="属性" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="仓储中心" Key="H.WarehouseCenterId" Value="H.WarehouseCenterId"/>
                                        <Item Caption="货主" Key="H.OwnerId" Value="H.OwnerId"/>
                                        <Item Caption="收货方名称" Key="H.RecvPartyName" Value="H.RecvPartyName"/>
                                        <Item Caption="省" Key="H.ProvinceId" Value="H.ProvinceId"/>
                                        <Item Caption="市" Key="H.CityId" Value="H.CityId"/>
                                        <Item Caption="承运商" Key="H.CarrierId" Value="H.CarrierId"/>
                                    </GridCell>
                                    <GridCell Key="Operator" Caption="操作符" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="Operator" Required="true"/>
                                        <Item Caption="等于" Key="Option1" Value="="/>
                                        <Item Caption="不等于" Key="Option2" Value="&lt;&gt;"/>
                                        <Item Caption="大于" Key="Option3" Value="&gt;"/>
                                        <Item Caption="大于等于" Key="Option4" Value="&gt;="/>
                                        <Item Caption="小于" Key="Option5" Value="&lt;"/>
                                        <Item Caption="小于等于" Key="Option6" Value="&lt;="/>
                                        <Item Caption="包含" Key="Option7" Value="like"/>
                                    </GridCell>
                                    <GridCell Key="Value" Caption="值" CellType="Dynamic" TypeFormula="GetCellValue('Grid1',-1,'ObjectAttrib')" TypeDependency="ObjectAttrib" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="Value" Required="true"/>
                                    </GridCell>
                                    <GridCell Key="RightBrackets" Caption="右括号" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="RightBrackets"/>
                                        <Item Caption=")" Key="ParenthesesRight1" Value=")"/>
                                        <Item Caption="))" Key="ParenthesesRight2" Value="))"/>
                                        <Item Caption=")))" Key="ParenthesesRight3" Value=")))"/>
                                    </GridCell>
                                    <GridCell Key="LogicalOperator" Caption="逻辑运算符" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="LogicalOperator"/>
                                        <Item Caption="并且" Key="And" Value="and"/>
                                        <Item Caption="或者" Key="Or" Value="or"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid2" Caption="库存匹配明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="LeftBrackets_02" Caption="左括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="ObjectAttrib_02" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="Operator_02" Caption="操作符" Width="80px" Sortable="true"/>
                                <GridColumn Key="Value_02" Caption="值" Width="80px" Sortable="true"/>
                                <GridColumn Key="RightBrackets_02" Caption="右括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="LogicalOperator_02" Caption="逻辑运算符" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_QM_L">
                                    <GridCell Key="LeftBrackets_02" Caption="左括号" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="LeftBrackets"/>
                                        <Item Caption="(" Key="ParenthesesLeft1" Value="("/>
                                        <Item Caption="((" Key="ParenthesesLeft2" Value="(("/>
                                        <Item Caption="(((" Key="ParenthesesLeft3" Value="((("/>
                                    </GridCell>
                                    <GridCell Key="ObjectAttrib_02" Caption="属性" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="仓间代码" Key="R.Code" Value="R.Code"/>
                                        <Item Caption="库区代码" Key="A.Code" Value="A.Code"/>
                                        <Item Caption="储位代码" Key="L.Code" Value="L.Code"/>
                                        <Item Caption="储位类型" Key="L.LocTypeId" Value="L.LocTypeId"/>
                                        <Item Caption="储位ABC分类" Key="L.ABCType" Value="L.ABCType"/>
                                    </GridCell>
                                    <GridCell Key="Operator_02" Caption="操作符" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="Operator" Required="true"/>
                                        <Item Caption="等于" Key="Option1" Value="="/>
                                        <Item Caption="不等于" Key="Option2" Value="&lt;&gt;"/>
                                        <Item Caption="大于" Key="Option3" Value="&gt;"/>
                                        <Item Caption="大于等于" Key="Option4" Value="&gt;="/>
                                        <Item Caption="小于" Key="Option5" Value="&lt;"/>
                                        <Item Caption="小于等于" Key="Option6" Value="&lt;="/>
                                        <Item Caption="包含" Key="Option7" Value="like"/>
                                    </GridCell>
                                    <GridCell Key="Value_02" Caption="值" CellType="Dynamic" TypeFormula="GetCellValue('Grid2',-1,'ObjectAttrib_02')" TypeDependency="ObjectAttrib" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="Value" Required="true"/>
                                    </GridCell>
                                    <GridCell Key="RightBrackets_02" Caption="右括号" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="RightBrackets"/>
                                        <Item Caption=")" Key="ParenthesesRight1" Value=")"/>
                                        <Item Caption="))" Key="ParenthesesRight2" Value="))"/>
                                        <Item Caption=")))" Key="ParenthesesRight3" Value=")))"/>
                                    </GridCell>
                                    <GridCell Key="LogicalOperator_02" Caption="逻辑运算符" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="LogicalOperator"/>
                                        <Item Caption="并且" Key="And" Value="and"/>
                                        <Item Caption="或者" Key="Or" Value="or"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid3" Caption="库存排序明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="ObjectAttrib_03" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="AscDesc_03" Caption="排序方向" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_QS_L">
                                    <GridCell Key="ObjectAttrib_03" Caption="属性" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="储位代码" Key="L.Code" Value="L.Code"/>
                                        <Item Caption="储位ABC分类" Key="L.ABCType" Value="L.ABCType"/>
                                        <Item Caption="储位排序" Key="L.SortOrder" Value="L.SortOrder"/>
                                        <Item Caption="入库日期" Key="Q.RecvDate" Value="Q.RecvDate"/>
                                        <Item Caption="批号" Key="Q.BatchNo" Value="Q.BatchNo"/>
                                        <Item Caption="失效日期" Key="Q.ExpireDate" Value="Q.ExpireDate"/>
                                    </GridCell>
                                    <GridCell Key="AscDesc_03" Caption="排序方向" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="AscDesc" Required="true"/>
                                        <Item Caption="升序" Key="ASC" Value="ASC"/>
                                        <Item Caption="降序" Key="DESC" Value="DESC"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid4" Caption="整件库存匹配明细" Enable="!ReadOnly() &amp;&amp; StrategyType==5">
                            <GridColumnCollection>
                                <GridColumn Key="LeftBrackets_04" Caption="左括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="ObjectAttrib_04" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="Operator_04" Caption="操作符" Width="80px" Sortable="true"/>
                                <GridColumn Key="Value_04" Caption="值" Width="80px" Sortable="true"/>
                                <GridColumn Key="RightBrackets_04" Caption="右括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="LogicalOperator_04" Caption="逻辑运算符" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_PQM_L">
                                    <GridCell Key="LeftBrackets_04" Caption="左括号" CellType="ComboBox">
                                        <DataBinding ColumnKey="LeftBrackets"/>
                                        <Item Caption="(" Key="ParenthesesLeft1" Value="("/>
                                        <Item Caption="((" Key="ParenthesesLeft2" Value="(("/>
                                        <Item Caption="(((" Key="ParenthesesLeft3" Value="((("/>
                                    </GridCell>
                                    <GridCell Key="ObjectAttrib_04" Caption="属性" CellType="ComboBox">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="仓间代码" Key="R.Code" Value="R.Code"/>
                                        <Item Caption="库区代码" Key="A.Code" Value="A.Code"/>
                                        <Item Caption="储位代码" Key="L.Code" Value="L.Code"/>
                                        <Item Caption="储位类型" Key="L.LocTypeId" Value="L.LocTypeId"/>
                                        <Item Caption="储位ABC分类" Key="L.ABCType" Value="L.ABCType"/>
                                    </GridCell>
                                    <GridCell Key="Operator_04" Caption="操作符" CellType="ComboBox">
                                        <DataBinding ColumnKey="Operator" Required="true"/>
                                        <Item Caption="等于" Key="Option1" Value="="/>
                                        <Item Caption="不等于" Key="Option2" Value="&lt;&gt;"/>
                                        <Item Caption="大于" Key="Option3" Value="&gt;"/>
                                        <Item Caption="大于等于" Key="Option4" Value="&gt;="/>
                                        <Item Caption="小于" Key="Option5" Value="&lt;"/>
                                        <Item Caption="小于等于" Key="Option6" Value="&lt;="/>
                                        <Item Caption="包含" Key="Option7" Value="like"/>
                                    </GridCell>
                                    <GridCell Key="Value_04" Caption="值" CellType="Dynamic" TypeFormula="GetCellValue('Grid4',-1,'ObjectAttrib_04')" TypeDependency="ObjectAttrib">
                                        <DataBinding ColumnKey="Value" Required="true"/>
                                    </GridCell>
                                    <GridCell Key="RightBrackets_04" Caption="右括号" CellType="ComboBox">
                                        <DataBinding ColumnKey="RightBrackets"/>
                                        <Item Caption=")" Key="ParenthesesRight1" Value=")"/>
                                        <Item Caption="))" Key="ParenthesesRight2" Value="))"/>
                                        <Item Caption=")))" Key="ParenthesesRight3" Value=")))"/>
                                    </GridCell>
                                    <GridCell Key="LogicalOperator_04" Caption="逻辑运算符" CellType="ComboBox">
                                        <DataBinding ColumnKey="LogicalOperator"/>
                                        <Item Caption="并且" Key="And" Value="and"/>
                                        <Item Caption="或者" Key="Or" Value="or"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid5" Caption="整件库存排序明细" Enable="StrategyType==5">
                            <GridColumnCollection>
                                <GridColumn Key="ObjectAttrib_05" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="AscDesc_05" Caption="排序方向" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_PQS_L">
                                    <GridCell Key="ObjectAttrib_05" Caption="属性" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="储位代码" Key="L.Code" Value="L.Code"/>
                                        <Item Caption="储位ABC分类" Key="L.ABCType" Value="L.ABCType"/>
                                        <Item Caption="排序" Key="L.SortOrder" Value="L.SortOrder"/>
                                        <Item Caption="入库日期" Key="Q.RecvDate" Value="Q.RecvDate"/>
                                        <Item Caption="批号" Key="Q.BatchNo" Value="Q.BatchNo"/>
                                        <Item Caption="失效日期" Key="Q.ExpireDate" Value="Q.ExpireDate"/>
                                    </GridCell>
                                    <GridCell Key="AscDesc_05" Caption="排序方向" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="AscDesc"/>
                                        <Item Caption="升序" Key="ASC" Value="ASC"/>
                                        <Item Caption="降序" Key="DESC" Value="DESC"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid6" Caption="发货区匹配明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="LeftBrackets_06" Caption="左括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="ObjectAttrib_06" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="Operator_06" Caption="操作符" Width="80px" Sortable="true"/>
                                <GridColumn Key="Value_06" Caption="值" Width="80px" Sortable="true"/>
                                <GridColumn Key="RightBrackets_06" Caption="右括号" Width="80px" Sortable="true"/>
                                <GridColumn Key="LogicalOperator_06" Caption="逻辑运算符" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_SM_L">
                                    <GridCell Key="LeftBrackets_06" Caption="左括号" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="LeftBrackets"/>
                                        <Item Caption="(" Key="ParenthesesLeft1" Value="("/>
                                        <Item Caption="((" Key="ParenthesesLeft2" Value="(("/>
                                        <Item Caption="(((" Key="ParenthesesLeft3" Value="((("/>
                                    </GridCell>
                                    <GridCell Key="ObjectAttrib_06" Caption="属性" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="库区代码" Key="A.Code" Value="A.Code"/>
                                        <Item Caption="储位代码" Key="L.Code" Value="L.Code"/>
                                        <Item Caption="储位类型" Key="L.LocTypeId" Value="L.LocTypeId"/>
                                    </GridCell>
                                    <GridCell Key="Operator_06" Caption="操作符" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="Operator" Required="true"/>
                                        <Item Caption="等于" Key="Option1" Value="="/>
                                        <Item Caption="不等于" Key="Option2" Value="&lt;&gt;"/>
                                        <Item Caption="大于" Key="Option3" Value="&gt;"/>
                                        <Item Caption="大于等于" Key="Option4" Value="&gt;="/>
                                        <Item Caption="小于" Key="Option5" Value="&lt;"/>
                                        <Item Caption="小于等于" Key="Option6" Value="&lt;="/>
                                        <Item Caption="包含" Key="Option7" Value="like"/>
                                    </GridCell>
                                    <GridCell Key="Value_06" Caption="值" CellType="Dynamic" TypeFormula="GetCellValue('Grid6',-1,'ObjectAttrib_06')" TypeDependency="ObjectAttrib" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="Value" Required="true"/>
                                    </GridCell>
                                    <GridCell Key="RightBrackets_06" Caption="右括号" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="RightBrackets"/>
                                        <Item Caption=")" Key="ParenthesesRight1" Value=")"/>
                                        <Item Caption="))" Key="ParenthesesRight2" Value="))"/>
                                        <Item Caption=")))" Key="ParenthesesRight3" Value=")))"/>
                                    </GridCell>
                                    <GridCell Key="LogicalOperator_06" Caption="逻辑运算符" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="LogicalOperator"/>
                                        <Item Caption="并且" Key="And" Value="and"/>
                                        <Item Caption="或者" Key="Or" Value="or"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                        <Grid Key="Grid7" Caption="发货区排序明细" Enable="!ReadOnly()">
                            <GridColumnCollection>
                                <GridColumn Key="ObjectAttrib_07" Caption="属性" Width="80px" Sortable="true"/>
                                <GridColumn Key="AscDesc_07" Caption="排序方向" Width="80px" Sortable="true"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="LRP_NoticePickStrategy_SS_L">
                                    <GridCell Key="ObjectAttrib_07" Caption="属性" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="ObjectAttrib" Required="true"/>
                                        <Item Caption="储位代码" Key="L.Code" Value="L.Code"/>
                                        <Item Caption="排序" Key="L.SortOrder" Value="L.SortOrder"/>
                                    </GridCell>
                                    <GridCell Key="AscDesc_07" Caption="排序方向" CellType="ComboBox" Enable="!ReadOnly()">
                                        <DataBinding ColumnKey="AscDesc"/>
                                        <Item Caption="升序" Key="ASC" Value="ASC"/>
                                        <Item Caption="降序" Key="DESC" Value="DESC"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                    </TabPanel>
                    <SplitSize Size="300px"/>
                    <SplitSize Size="100%"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
    <MacroCollection>
        <Macro Key="MatchWhereSql_Save">
            <![CDATA[//条件匹配明细
var sql=' ';
var i=0;
var count = GetRowCount('Grid1',false);
//遍历grid1
if(count>0){
while ( i < count ) {
	//条件匹配明细保存时将明细的内容拼成Where子句放到头挡匹配条件SQL字段中
	if(GetCellValue('Grid1', i, 'LeftBrackets')!=''){
		sql=sql+GetCellValue('Grid1', i, 'LeftBrackets')+' ';
	}
	if(GetCellValue('Grid1', i, 'ObjectAttrib')!=''){
		sql=sql+GetCellValue('Grid1', i, 'ObjectAttrib')+' ';
	}
	if(GetCellValue('Grid1', i, 'Operator')+' '!=''){
		sql=sql+GetCellValue('Grid1', i, 'Operator')+' ';
	}
	if(GetCellValue('Grid1', i, 'Value')+' '!=''){
		sql=sql+ "'" + GetCellValue('Grid1', i, 'Value')+ "' ";
	}
	if(GetCellValue('Grid1', i, 'RightBrackets')+' '!=''){
		sql=sql+GetCellValue('Grid1', i, 'RightBrackets')+' ';
	}
	if(GetCellValue('Grid1', i, 'LogicalOperator')+' '!=''){
		sql=sql+GetCellValue('Grid1', i, 'LogicalOperator')+' ';
	}
	//条件匹配明细保存若不是最后一行，则逻辑运算符不可为空
   if(i==count-1){
		if(GetCellValue('Grid1', i, 'LogicalOperator')!='')
		{
			Confirm(LocaleString('CHshow','chkey25'),'OK','OK:{}'); 
			break;
		}
	else{
		   if(sql != ''){
				SetValue('MatchWhereSql', sql);
                var ErrorMassagse = LocaleString('STshow','stkey8');
				InvokeService("LRP_StategySqlCheck", true, true,MatchCheckSql,MatchWhereSql,ErrorMassagse);
                                return true;
		   }
		 }
	}else{
		if(GetCellValue('Grid1', i, 'LogicalOperator')==''){
			Confirm(LocaleString('CHshow','chkey26'),'OK','OK:{}'); 
			break;
		}
	}
   i=i+1;
}
}else{
        SetValue('MatchWhereSql', '');
	return true;
  }]]>
        </Macro>
        <Macro Key="QuantWhereSql_Save">
            <![CDATA[
//库存匹配明细保存时将明细的内容拼成子句放到头挡库存匹配SQL字段中
var sql2=' ';
var j=0;
var count2 = GetRowCount('Grid2',false);
  //遍历Grid2
if(count2>0){
	while ( j < count2 ) {
		//库存匹配明细保存时将明细的内容拼成Where子句放到头挡库存匹配SQL字段中
		if(GetCellValue('Grid2', j, 'LeftBrackets_02')!=''){
			sql2=sql2+GetCellValue('Grid2', j, 'LeftBrackets_02')+' ';
		}
		if(GetCellValue('Grid2', j, 'ObjectAttrib_02')!=''){
			sql2=sql2+GetCellValue('Grid2', j, 'ObjectAttrib_02')+' ';
		}
		if(GetCellValue('Grid2', j, 'Operator_02')+' '!=''){
			sql2=sql2+GetCellValue('Grid2', j, 'Operator_02')+' ';
		}
		if(GetCellValue('Grid2', j, 'Value_02')+' '!=''){
			sql2=sql2+"'"+ToString(GetCellValue('Grid2', j, 'Value_02'))+"' ";
		}
		if(GetCellValue('Grid2', j, 'RightBrackets_02')+' '!=''){
			sql2=sql2+GetCellValue('Grid2', j, 'RightBrackets_02')+' ';
		}
		if(GetCellValue('Grid2', j, 'LogicalOperator_02')+' '!=''){
			sql2=sql2+GetCellValue('Grid2', j, 'LogicalOperator_02')+' ';
		}
		//库存匹配明细保存若不是最后一行，则逻辑运算符不可为空											
	 if(j==count2-1){
			if(GetCellValue('Grid2', j, 'LogicalOperator_02')!='')
			{
				Confirm(LocaleString('CHshow','chkey25'),'OK','OK:{}'); 
				break;
			}
		else{
				if(sql2 != ''){
					SetValue('QuantWhereSql', sql2);
					return true;
				}
			  }
			}else{
			if(GetCellValue('Grid2', j, 'LogicalOperator_02')==''){
				Confirm(LocaleString('CHshow','chkey26'),'OK','OK:{}'); 
				break;
			}
		}
	   j=j+1;
	}
	}
	else
	{
        SetValue('QuantWhereSql', '');
	return true;
	  }
]]>
        </Macro>
        <Macro Key="QuantSortSql_Save">
            <![CDATA[
//库存排序明细保存时将明细的内容拼成排序子句放到头挡库存排序SQL字段中
var count3 = GetRowCount('Grid3',false);
var k=0;
var orderStr3=' ';
if(count3>0){
while(k<count3){
	if(k==count3-1){
		orderStr3=orderStr3+GetCellValue('Grid3', k, 'ObjectAttrib_03')+' '+GetCellValue('Grid3', k, 'AscDesc_03');
		if(orderStr3 != ''){
			SetValue('QuantSortSql', orderStr3);
			var ErrorMassagse = '验证库存匹配有效性时出错，请检查库存检查SQL、库存匹配SQL和库存排序SQL';
			InvokeService("LRP_StategySqlCheck", true, true,QuantCheckSql,QuantWhereSql,QuantSortSql,"验证库存匹配有效性时出错，请检查库存检查SQL、库存匹配SQL和库存排序SQL");
                        return true;
		}
	}else{
		orderStr3=orderStr3+GetCellValue('Grid3', k, 'ObjectAttrib_03')+' '+GetCellValue('Grid3', k, 'AscDesc_03')+',';
	}
	k=k+1;
}
}
else
	{
        SetValue('QuantSortSql', '');
	return true;  
}]]>
        </Macro>
        <Macro Key="PackQuantWhereSql_Save">
            <![CDATA[
//整件库存匹配明细保存时将明细的内容拼成子句放到头挡库存匹配SQL字段中
var sql4=' ';
var j=0;
var count4 = GetRowCount('Grid4',false);
  //遍历Grid4
if(count4>0){
	while ( j < count4 ) {
		//整件库存匹配明细保存时将明细的内容拼成Where子句放到头挡整件库存匹配SQL字段中
		if(GetCellValue('Grid4', j, 'LeftBrackets_04')!=''){
			sql4=sql4+GetCellValue('Grid4', j, 'LeftBrackets_04')+' ';
		}
		if(GetCellValue('Grid4', j, 'ObjectAttrib_04')!=''){
			sql4=sql4+GetCellValue('Grid4', j, 'ObjectAttrib_04')+' ';
		}
		if(GetCellValue('Grid4', j, 'Operator_04')+' '!=''){
			sql4=sql4+GetCellValue('Grid4', j, 'Operator_04')+' ';
		}
		if(GetCellValue('Grid4', j, 'Value_04')+' '!=''){
			sql4=sql4+"'"+ToString(GetCellValue('Grid4', j, 'Value_04'))+"' ";
		}
		if(GetCellValue('Grid4', j, 'RightBrackets_04')+' '!=''){
			sql4=sql4+GetCellValue('Grid4', j, 'RightBrackets_04')+' ';
		}
		if(GetCellValue('Grid4', j, 'LogicalOperator_04')+' '!=''){
			sql4=sql4+GetCellValue('Grid4', j, 'LogicalOperator_04')+' ';
		}
		//整件库存匹配明细保存若不是最后一行，则逻辑运算符不可为空											
	 if(j==count4-1){
			if(GetCellValue('Grid4', j, 'LogicalOperator_04')!='')
			{
				Confirm(LocaleString('CHshow','chkey25'),'OK','OK:{}'); 
				break;
			}
		else{
				if(sql4 != ''){
					SetValue('PackQuantWhereSql', sql4);
					return true;
				}
			  }
			}else{
			if(GetCellValue('Grid4', j, 'LogicalOperator_04')==''){
				Confirm(LocaleString('CHshow','chkey26'),'OK','OK:{}'); 
				break;
			}
		}
	   j=j+1;
	}
	}
	else
	{
        SetValue('PackQuantWhereSql', '');
	return true;
	  }
]]>
        </Macro>
        <Macro Key="PackQuantSortSql_Save">
            <![CDATA[
//整件库存排序明细保存时将明细的内容拼成排序子句放到头挡库存排序SQL字段中
var count5 = GetRowCount('Grid5',false);
var m = 0;
var orderStr5=' ';
if(count5>0){
while(m<count5){
	if(m==count5-1){
		orderStr5=orderStr5+GetCellValue('Grid5', m, 'ObjectAttrib_05')+' '+GetCellValue('Grid5', m, 'AscDesc_05');
		if(orderStr5 != ''){
			SetValue('PackQuantSortSql', orderStr5);
			var ErrorMassagse = '验证整件库存匹配有效性时出错，请检查整件库存匹配SQL和整件库存排序SQL';
			InvokeService("LRP_StategySqlCheck", true, true,QuantCheckSql,PackQuantWhereSql,PackQuantSortSql,"验证整件库存匹配有效性时出错，请检查整件库存匹配SQL和整件库存排序SQL");
                        return true;
		}
	}else{
		orderStr5=orderStr5+GetCellValue('Grid5', m, 'ObjectAttrib_05')+' '+GetCellValue('Grid5', m, 'AscDesc_05')+',';
	}
	m=m+1;
}
}
else
	{
        SetValue('PackQuantSortSql', '');
	return true;  
}]]>
        </Macro>
        <Macro Key="ShipLocWhereSql_Save">
            <![CDATA[
//发货区匹配明细保存时将明细的内容拼成子句放到头挡发货区匹配SQL字段中
var sql6=' ';
var n=0;
var count6 = GetRowCount('Grid6',false);
  //遍历Grid6
if(count6>0){
	while ( n < count6 ) {
		//发货区匹配明细保存时将明细的内容拼成Where子句放到头挡发货区匹配SQL字段中
		if(GetCellValue('Grid6', n, 'LeftBrackets_06')!=''){
			sql6=sql6+GetCellValue('Grid6', n, 'LeftBrackets_06')+' ';
		}
		if(GetCellValue('Grid6', n, 'ObjectAttrib_06')!=''){
			sql6=sql6+GetCellValue('Grid6', n, 'ObjectAttrib_06')+' ';
		}
		if(GetCellValue('Grid6', n, 'Operator_06')+' '!=''){
			sql6=sql6+GetCellValue('Grid6', n, 'Operator_06')+' ';
		}
		if(GetCellValue('Grid6', n, 'Value_06')+' '!=''){
			sql6=sql6+"'"+ToString(GetCellValue('Grid6', n, 'Value_06'))+"' ";
		}
		if(GetCellValue('Grid6', n, 'RightBrackets_06')+' '!=''){
			sql6=sql6+GetCellValue('Grid6', n, 'RightBrackets_06')+' ';
		}
		if(GetCellValue('Grid6', n, 'LogicalOperator_06')+' '!=''){
			sql6=sql6+GetCellValue('Grid6', n, 'LogicalOperator_06')+' ';
		}
		//发货区匹配明细保存若不是最后一行，则逻辑运算符不可为空											
	 if(n==count6-1){
			if(GetCellValue('Grid6', n, 'LogicalOperator_06')!='')
			{
				Confirm(LocaleString('CHshow','chkey25'),'OK','OK:{}'); 
				break;
			}
		else{
				if(sql6 != ''){
					SetValue('ShipLocWhereSql', sql6);
					return true;
				}
			  }
			}else{
			if(GetCellValue('Grid6', n, 'LogicalOperator_06')==''){
				Confirm(LocaleString('CHshow','chkey26'),'OK','OK:{}'); 
				break;
			}
		}
	   n=n+1;
	}
	}
	else
	{
        SetValue('ShipLocWhereSql', '');
	return true;
	  }
]]>
        </Macro>
        <Macro Key="ShipLocSortSql_Save">
            <![CDATA[
//发货区排序明细保存时将明细的内容拼成排序子句放到头挡发货区排序SQL字段中
var count7 = GetRowCount('Grid7',false);
var p = 0;
var orderStr7=' ';
if(count7>0){
while(p<count7){
	if(p==count7-1){
		orderStr7=orderStr7+GetCellValue('Grid7', p, 'ObjectAttrib_07')+' '+GetCellValue('Grid7', p, 'AscDesc_07');
		if(orderStr7 != ''){
			SetValue('ShipLocSortSql', orderStr7);
			var ErrorMassagse = '验证发货区条件匹配有效性时出错，请检查发货区匹配SQL和发货区排序SQL';
			InvokeService("LRP_StategySqlCheck", true, true,ShipLocCheckSql,ShipLocWhereSql,ShipLocSortSql,"验证发货区条件匹配有效性时出错，请检查发货区匹配SQL和发货区排序SQL");
                        return true;
		}
	}else{
		orderStr7=orderStr7+GetCellValue('Grid7', p, 'ObjectAttrib_07')+' '+GetCellValue('Grid7', p, 'AscDesc_07')+',';
	}
	p=p+1;
}
}
else
	{
        SetValue('ShipLocSortSql', '');
	return true;  
}]]>
        </Macro>
    </MacroCollection>
</Form>
