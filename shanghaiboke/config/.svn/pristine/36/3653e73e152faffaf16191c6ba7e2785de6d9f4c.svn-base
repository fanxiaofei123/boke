<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="Driver" FormType="Entity" Authenticate="false">
    <DataSource>
        <DataObject Caption="司机" Key="Driver" PrimaryTableKey="LRP_Driver">
            <TableCollection>
                <Table Caption="货主用户" Key="LRP_Driver" SourceType="Query" Persist="false">
                    <Column Key="AvatarUrl" Caption="头像路径" DataType="Varchar" Length="200"/>
                    <Column Key="Name" Caption="名称" DataType="Varchar" Length="200"/>
                    <TableFilter>
                        <![CDATA[LRP_Driver.OID=?]]>
                    </TableFilter>
                    <ParameterCollection>
                        <Parameter Formula="GetUserOperator()"/>
                    </ParameterCollection>
                </Table>
            </TableCollection>
        </DataObject>
    </DataSource>
    <QueryCollection>
        <Query Key="UpdateDriver" Description="修改司机端app使用状态时离线">
            <Statement>
                <![CDATA[
					update LRP_Driver set AppStatus = 0 where oid = ?
				]]>
            </Statement>
            <ParameterCollection>
                <Parameter DataType="Long"/>
            </ParameterCollection>
        </Query>
        <Query Key="UpdateDriverSign" Description="填写签到表上签退时间，app使用状态是离线">
            <Statement>
                <![CDATA[
					update LRP_DriverSign set SignOffTime = ?,SignStatus=0 where DriverId = ? and SignStatus=1
				]]>
            </Statement>
        </Query>
    </QueryCollection>
    <Body>
        <Block>
            <GridLayoutPanel Key="root_pnl">
                <TableView Key="root" X="0" Y="0">
                    <Format BackColor="#f1f3f8"/>
                    <TableRowCollection>
                        <TableRow Key="r1">
                            <GridLayoutPanel Key="header" Height="190px">
                                <Format BackColor="#f1f3f8"/>
                                <Image Key="mylogo" Caption="我的头像" Stretch="true" ImageScaleType="Fit_XY" PromptImage="5.png" X="1" Y="1" BorderStyle="none">
                                    <DataBinding TableKey="LRP_Driver" ColumnKey="AvatarUrl"/>
                                    <Format BackColor="#f1f3f8"/>
                                    <OnClick>
                                        <![CDATA[
											if ( !IsLogin() ) {
												Show('DriverLogin')
											} else {
												Show('DriverInfo')
											}
										]]>
                                    </OnClick>
                                </Image>
                                <Label Key="myTip" Caption="点击登录" X="1" Y="2">
                                    <DataBinding TableKey="LRP_Driver" ColumnKey="Name"/>
                                    <Format ForeColor="#f14c52" HAlign="Center">
                                        <Font Size="14"/>
                                    </Format>
                                </Label>
                                <RowDefCollection>
                                    <RowDef Height="35px"/>
                                    <RowDef Height="120px"/>
                                    <RowDef Height="28px"/>
                                </RowDefCollection>
                                <ColumnDefCollection>
                                    <ColumnDef Width="50%"/>
                                    <ColumnDef Width="120px"/>
                                    <ColumnDef Width="50%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                        </TableRow>
                        <TableRow Key="r2" TopMargin="5px" SeparatorStyle="solid none" SeparatorColor="#dde0e7">
                            <LinearLayoutPanel Key="service_center_panel" Height="52px" Orientation="Horizontal">
                                <Button Key="service_center_icon" Icon="my_service-center.png" Width="30px" Height="auto" BorderStyle="none" Margin="12px">
                                    <Format BackColor="transparent"/>
                                </Button>
                                <Label Key="service_center_label" Caption="司机软件操作指南" Width="10px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#969696">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <Button Key="service_center_more" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                            <RowClick>
                                <![CDATA[Show('DriverInstructions')]]>
                            </RowClick>
                        </TableRow>
                        <TableRow Key="r3" SeparatorStyle="none none solid none" SeparatorColor="#e6eaf2">
                            <LinearLayoutPanel Key="driverSign_panel" Height="52px" Orientation="Horizontal">
                                <Button Key="driverSign_icon" Icon="my_cooperation.png" Width="30px" Height="auto" BorderStyle="none" Margin="12px">
                                    <Format BackColor="transparent"/>
                                </Button>
                                <Label Key="driverSign_label" Caption="签到" Width="10px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#969696">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <Button Key="driverSign_more" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                            <RowClick>
                                <![CDATA[New('DriverSign')]]>
                            </RowClick>
                        </TableRow>
                        <TableRow Key="r7" SeparatorStyle="none none solid none" SeparatorColor="#e6eaf2">
                            <LinearLayoutPanel Key="AbsenceRequest" Height="52px" Orientation="Horizontal">
                                <Button Key="AbsenceRequest_icon" Icon="my_service-center.png" Width="30px" Height="auto" BorderStyle="none" Margin="12px">
                                    <Format BackColor="transparent"/>
                                </Button>
                                <Label Key="AbsenceRequest_label" Caption="请假" Width="10px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#969696">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <Button Key="AbsenceRequest_more" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                            <RowClick>
                                <![CDATA[Show('HistoryAbsenceRequest')]]>
                            </RowClick>
                        </TableRow>
                        <TableRow Key="r4" SeparatorStyle="none none solid none" SeparatorColor="#e6eaf2">
                            <LinearLayoutPanel Key="cooperation_panel" Height="52px" Orientation="Horizontal">
                                <Button Key="cooperation_icon" Icon="my_cooperation.png" Width="30px" Height="auto" BorderStyle="none" Margin="12px">
                                    <Format BackColor="transparent"/>
                                </Button>
                                <Label Key="ServiceStandard_label" Caption="服务标准" Width="10px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#969696">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <Button Key="cooperation_more" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                            <RowClick>
                                <![CDATA[Show('DriverChargeStandards')]]>
                            </RowClick>
                        </TableRow>
                        <TableRow Key="r5" SeparatorStyle="none none solid none" SeparatorColor="#e6eaf2">
                            <LinearLayoutPanel Key="contact_panel" Height="52px" Orientation="Horizontal">
                                <Button Key="contact_icon" Icon="my_contactus.png" Width="30px" Height="auto" BorderStyle="none" Margin="12px">
                                    <Format BackColor="transparent"/>
                                </Button>
                                <Label Key="contact_label" Caption="关于我们" Width="10px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#969696">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <Button Key="contact_more" Icon="more_arrow.png" OnlyIcon="True" Width="20px" Height="auto" BorderStyle="none">
                                    <Format BackColor="transparent"/>
                                </Button>
                            </LinearLayoutPanel>
                            <RowClick>
                                <![CDATA[Show('AboutDriver')]]>
                            </RowClick>
                        </TableRow>
                    </TableRowCollection>
                </TableView>
                <GridLayoutPanel Key="Out_layout" X="0" Y="1" Height="50px" Visible="myTip!=''">
                    <Button Key="Out" Caption="退出当前登录" X="1" Y="0" Visible="myTip!=''">
                        <Format ForeColor="#ffffff" BackColor="#f14c52">
                            <Font Size="16"/>
                        </Format>
                        <OnClick>
                            <![CDATA[
							DBNamedUpdate('UpdateDriver',GetOperator());
							DBNamedUpdate('UpdateDriverSign',ServerDate(),GetOperator());
							GuestLogout();
							LoadData();
							ShowToast('已注销当前登录');
						]]>
                        </OnClick>
                    </Button>
                    <RowDefCollection>
                        <RowDef Height="45px"/>
                    </RowDefCollection>
                    <ColumnDefCollection>
                        <ColumnDef Width="20px"/>
                        <ColumnDef Width="100%"/>
                        <ColumnDef Width="20px"/>
                    </ColumnDefCollection>
                </GridLayoutPanel>
                <RowDefCollection>
                    <RowDef Height="100%"/>
                    <RowDef Height="45px"/>
                </RowDefCollection>
                <ColumnDefCollection>
                    <ColumnDef Width="100%"/>
                </ColumnDefCollection>
            </GridLayoutPanel>
        </Block>
    </Body>
    <OnLoad>
        <![CDATA[LoadData()]]>
    </OnLoad>
    <EventHandlerCollection>
        <EventHandler Key="SessionChanged" Trigger="Show" MergeEvent="true">
            <![CDATA[LoadData()]]>
        </EventHandler>
        <EventHandler Key="UserInfoChanged" Trigger="Show" MergeEvent="true">
            <![CDATA[LoadData()]]>
        </EventHandler>
    </EventHandlerCollection>
    <NavigationBar BackColor="#f14c52" Style="Custom">
        <BarItem Key="TitleCenter_bar" Caption="我的" Location="Center">
            <Label Key="TitleCenter" Caption="我的" Width="60px">
                <Format ForeColor="#ffffff" HAlign="Center">
                    <Font Size="20"/>
                </Format>
            </Label>
        </BarItem>
    </NavigationBar>
</Form>
