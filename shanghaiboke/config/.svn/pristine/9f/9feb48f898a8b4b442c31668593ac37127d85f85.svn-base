<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Caption="调度组织" FormType="Dict" Key="V_DispatchOrg_LRP">
    <DataSource RefObjectKey="LRP_DispatchOrg"/>
    <UICheckRuleCollection>
        <UICheckRule ErrorInfo="明细调度组织不能重复">
            <![CDATA[
							!CheckDuplicate("DispatchOrgId"); 
						]]>
        </UICheckRule>
        <UICheckRule ErrorInfo="城市不能重复">
            <![CDATA[
							!CheckDuplicate("CityId"); 
						]]>
        </UICheckRule>
    </UICheckRuleCollection>
    <Body>
        <Block>
            <SplitPanel Height="100%" Key="main_split" Orientation="Vertical">
                <TabPanel Caption="TabPanel0" Key="TabPanel0">
                    <GridLayoutPanel Caption="基本信息" Key="BasicTab" Padding="10px">
                        <Label Caption="代码" Key="L_Code" X="0" Y="0"/>
                        <TextEditor Caption="代码" Enable="!ReadOnly()" Key="Code" Tip="「代码」不可为空" X="1" XSpan="3" Y="0">
                            <DataBinding ColumnKey="Code" Required="true" TableKey="LRP_DispatchOrg"/>
                        </TextEditor>
                        <Label Caption="名称" Key="L_Name" X="5" Y="0"/>
                        <TextEditor Caption="名称" Enable="!ReadOnly()" Key="Name" Tip="「名称」不可为空" X="6" XSpan="3" Y="0">
                            <DataBinding ColumnKey="Name" Required="true" TableKey="LRP_DispatchOrg"/>
                        </TextEditor>
                        <Label Caption="公司" Key="L_CompanyCodeId" X="0" Y="1"/>
                        <Dict Caption="公司" Key="CompanyCodeId" ItemKey="CompanyCode" X="1" XSpan="3" Y="1">
                            <DataBinding ColumnKey="CompanyCodeId" TableKey="LRP_DispatchOrg"/>
                        </Dict>
                        <Label Caption="成本中心" Key="L_CostCenterId" X="5" Y="1"/>
                        <Dict Caption="成本中心" Key="CostCenterId" ItemKey="CostCenter" X="6" XSpan="3" Y="1">
                            <DataBinding ColumnKey="CostCenterId" TableKey="LRP_DispatchOrg"/>
                        </Dict>
                        <CheckBox Caption="是否总调" Key="IsChiefDispatcher" X="0" XSpan="2" Y="2">
                            <DataBinding ColumnKey="IsChiefDispatcher" TableKey="LRP_DispatchOrg" DefaultValue="0">
                                <ValueChanged>
                                    <![CDATA[ClearAllRows('Grid0');]]>
                                </ValueChanged>
                            </DataBinding>
                        </CheckBox>
                        <CheckBox Caption="是否执行调度" Key="IsOpDispatcher" X="3" XSpan="2" Y="2">
                            <DataBinding ColumnKey="IsOpDispatcher" TableKey="LRP_DispatchOrg" DefaultValue="1"/>
                        </CheckBox>
                        <Dict Key="DefaultWarehouseCenterId" Caption="默认站点" BuddyKey="Lab_DefaultWarehouseCenterId" X="6" Y="2" ItemKey="LRP_WarehouseCenter" XSpan="3">
                            <DataBinding ColumnKey="DefaultWarehouseCenterId" TableKey="LRP_DispatchOrg"/>
                        </Dict>
                        <Label Key="Lab_DefaultWarehouseCenterId" Caption="默认站点" X="5" Y="2"/>
                        <RowDefCollection RowGap="8">
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="10">
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="77px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                    <GridLayoutPanel Caption="系统信息" Key="SystemTab" Padding="10px">
                        <Dict Caption="创建人" ItemKey="Operator" Key="CREATOR" X="1" Y="0">
                            <DataBinding ColumnKey="CREATOR" TableKey="LRP_DispatchOrg" DefaultFormulaValue="GetOperator()"/>
                        </Dict>
                        <DatePicker Caption="创建时间" Key="CREATETIME" X="1" Y="1">
                            <DataBinding ColumnKey="CREATETIME" TableKey="LRP_DispatchOrg" DefaultFormulaValue="ServerDate()"/>
                        </DatePicker>
                        <Dict Caption="修改人" ItemKey="Operator" Key="MODIFIER" X="1" Y="2">
                            <DataBinding ColumnKey="MODIFIER" TableKey="LRP_DispatchOrg" DefaultFormulaValue="GetOperator()"/>
                        </Dict>
                        <DatePicker Caption="修改时间" Key="MODIFYTIME" X="1" Y="3">
                            <DataBinding ColumnKey="MODIFYTIME" TableKey="LRP_DispatchOrg" DefaultFormulaValue="ServerDate()"/>
                        </DatePicker>
                        <Label Caption="创建人" Key="L_CREATOR" X="0" Y="0"/>
                        <Label Caption="创建时间" Key="L_CREATETIME" X="0" Y="1"/>
                        <Label Caption="修改人" Key="L_MODIFIER" X="0" Y="2"/>
                        <Label Caption="修改时间" Key="L_MODIFYTIME" X="0" Y="3"/>
                        <RowDefCollection RowGap="8">
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="8">
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="100%"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                </TabPanel>
                <TabPanel Caption="总调关联调度组织明细" Key="TabPanel1">
                    <Grid Caption="总调关联调度组织明细" Key="Grid0" Visible="IsChiefDispatcher">
                        <GridColumnCollection>
                            <GridColumn Caption="代码" Key="column-0" Width="80px"/>
                        </GridColumnCollection>
                        <GridRowCollection>
                            <GridRow Key="row1" TableKey="LRP_DispatchOrg_Op">
                                <GridCell Caption="调度组织" CellType="Dict" ItemKey="LRP_DispatchOrg" Key="DispatchOrgId" PromptText="「调度组织」不能为空">
                                    <DataBinding ColumnKey="DispatchOrgId" Required="true" TableKey="LRP_DispatchOrg_Op"/>
                                    <ItemFilter ItemKey="LRP_DispatchOrg">
                                        <Filter Type="DataSet" Query="select oid from lrp_dispatchorg where IsChiefDispatcher=0"/>
                                    </ItemFilter>
                                </GridCell>
                            </GridRow>
                        </GridRowCollection>
                    </Grid>
                    <Grid Caption="关联城市明细" Key="Grid1">
                        <GridColumnCollection>
                            <GridColumn Caption="省份" Key="column-1" Width="80px"/>
                            <GridColumn Caption="城市" Key="column-2" Width="80px"/>
                        </GridColumnCollection>
                        <GridRowCollection>
                            <GridRow Key="row2" TableKey="LRP_DispatchOrg_City">
                                <GridCell Caption="省份" CellType="Dict" ItemKey="LRP_Province" Key="ProvinceId">
                                    <DataBinding ColumnKey="ProvinceId" Required="true" TableKey="LRP_DispatchOrg_City"/>
                                </GridCell>
                                <GridCell Caption="城市" CellType="Dict" ItemKey="LRP_City" Key="CityId">
                                    <DataBinding ColumnKey="CityId" Required="true" TableKey="LRP_DispatchOrg_City"/>
                                    <ItemFilter ItemKey="LRP_City">
                                        <Filter Type="FieldValue">
                                            <FilterValue FieldKey="ProvinceId" RefValue="ProvinceId" Type="Field" Required="true"/>
                                        </Filter>
                                    </ItemFilter>
                                </GridCell>
                            </GridRow>
                        </GridRowCollection>
                    </Grid>
                </TabPanel>
                <SplitSize Size="38%"/>
                <SplitSize Size="62%"/>
            </SplitPanel>
        </Block>
    </Body>
</Form>
