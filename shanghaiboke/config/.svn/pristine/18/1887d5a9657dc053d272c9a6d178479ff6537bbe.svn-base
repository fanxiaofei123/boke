<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="MyReapplyPass"  FormType="Entity" Authenticate="false">
    <Body>
        <Block>
            <GridLayoutPanel Key="root_pnl">
                <TableView Key="main" X="0" Y="0">
                    <Format BackColor="#f1f3f8"/>
                    <TableRowCollection>
                        <TableRow Key="r1" SeparatorStyle="solid none" SeparatorColor="#dde0e7" TopMargin="10px">
                            <LinearLayoutPanel Key="r1_panel" Height="50px" Orientation="Horizontal" LeftPadding="10px">
                                <Label Key="lbl_Mobile" Caption="手机" Width="100px" Height="auto">
                                    <Format ForeColor="#969696">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <TextEditor Key="Mobile" Caption="手机" PromptText="手机" BorderStyle="none" Width="0px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#dde0e7">
                                        <Font Size="16"/>
                                    </Format>
                                </TextEditor>
                                <Button Key="Mobile_btn" Caption="发送验证码" Enable="True" Width="100px" Height="auto" BorderStyle="none">
                                    <Format ForeColor="#ffffff" BackColor="#f14c52">
                                        <Font Size="13"/>
                                    </Format>
                                    <OnClick>
                                        <![CDATA[
										if(IsNull(Mobile) || Length(Mobile) == 0){
											ShowToast("请输入手机号");
											return true;
										}
										InvokeUnsafeService('LRP_VerificationCodeSave', false, false , Mobile);
										ShowToast("验证码已发送");
										SetValue('Mobile_btn',90);
									]]>
                                    </OnClick>
                                </Button>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="Code_tablerow" SeparatorStyle="solid none" SeparatorColor="#dde0e7" TopMargin="10px">
                            <LinearLayoutPanel Key="Code_panel" Orientation="Horizontal" Height="50px" LeftPadding="10px">
                                <Label Key="lbl_Code" Caption="手机验证码" Width="100px" Height="auto">
                                    <Format ForeColor="#969696" BackColor="#ffffff">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <TextEditor Key="Code" Caption="手机验证码" PromptText="手机验证码" BorderStyle="none" Width="0px" Weight="1.0" Height="auto">
                                    <Format ForeColor="#dde0e7">
                                        <Font Size="16"/>
                                    </Format>
                                </TextEditor>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r2" SeparatorStyle="none none solid none" SeparatorColor="#dde0e7" TopMargin="10px">
                            <LinearLayoutPanel Key="r2_panel" Height="50px" Orientation="Horizontal">
                                <Label Key="lbl_new_pwd" Caption="新密码" LeftPadding="10px" Width="100px" Height="auto">
                                    <Format ForeColor="#969696" BackColor="#ffffff">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <PasswordEditor Key="new_pwd" Caption="新密码" PromptText="请输入新密码" Width="0px" Weight="1.0" Height="auto" BorderStyle="none">
                                    <Format BackColor="#ffffff">
                                        <Font Size="16"/>
                                    </Format>
                                </PasswordEditor>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r3" SeparatorStyle="none none solid none" SeparatorColor="#dde0e7" TopMargin="10px">
                            <LinearLayoutPanel Key="r3_panel" Height="50px" Orientation="Horizontal">
                                <Label Key="lbl_confirm_pwd" Caption="确认新密码" LeftPadding="10px" Width="100px" Height="auto">
                                    <Format ForeColor="#969696" BackColor="#ffffff">
                                        <Font Size="16"/>
                                    </Format>
                                </Label>
                                <PasswordEditor Key="confirm_pwd" Caption="确认新密码" PromptText="请再次输入新密码" Width="0px" Weight="1.0" Height="auto" BorderStyle="none">
                                    <Format BackColor="#ffffff">
                                        <Font Size="16"/>
                                    </Format>
                                </PasswordEditor>
                            </LinearLayoutPanel>
                        </TableRow>
                    </TableRowCollection>
                </TableView>
                <GridLayoutPanel Key="opt_panel" X="0" Y="1">
                    <Format BackColor="#f1f3f8"/>
                    <Button Key="order" Caption="确定" Enable="True" Height="auto" BorderStyle="none" X="1" Y="0">
                        <Format ForeColor="#ffffff" BackColor="#f14c52">
                            <Font Size="16"/>
                        </Format>
                        <OnClick>
                            <![CDATA[
								InvokeUnsafeService('LRP_ReapplyPassword', false, false , Mobile,Code,EncryptPassword(new_pwd),EncryptPassword(confirm_pwd));
								ShowToast("密码重置成功！");
								Close();
								]]>
                        </OnClick>
                    </Button>
                    <RowDefCollection>
                        <RowDef Height="45px"/>
                    </RowDefCollection>
                    <ColumnDefCollection>
                        <ColumnDef Width="20px"/>
                        <ColumnDef Width="100%"/>
                        <ColumnDef Width="20px"/>
                    </ColumnDefCollection>
                </GridLayoutPanel>
                <RowDefCollection>
                    <RowDef Height="100%"/>
                    <RowDef Height="45px"/>
                </RowDefCollection>
                <ColumnDefCollection>
                    <ColumnDef Width="100%"/>
                </ColumnDefCollection>
            </GridLayoutPanel>
        </Block>
        <ViewCollection>
            <View Key="All"/>
        </ViewCollection>
    </Body>
    <TimerTaskCollection>
        <TimerTask Key="MessageNotice" Period="1000" Repeat="true" Enable="True">
            <![CDATA[
				if(Mobile_btn>0&&Mobile_btn<=90){
					SetValue('Mobile_btn',Mobile_btn-1);
					SetEnable('Mobile_btn',false);
				}
				if(Mobile_btn==1){
					SetValue('Mobile_btn','发送验证码');
					SetEnable('Mobile_btn',true);
					return true;
				}
            ]]>
        </TimerTask>
    </TimerTaskCollection>
    <NavigationBar BackColor="#f14c52" Style="Custom">
        <BarItem Key="TitleCenter_bar" Caption="重申密码" Location="Center">
            <Label Key="TitleCenter" Caption="重申密码" Width="100%">
                <Format ForeColor="#ffffff" HAlign="Center">
                    <Font Size="20"/>
                </Format>
            </Label>
        </BarItem>
    </NavigationBar>
</Form>
