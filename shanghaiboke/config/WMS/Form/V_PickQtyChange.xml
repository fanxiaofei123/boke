<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Caption="拣货调整" FormType="View" Key="V_PickQtyChange">
    <DataSource RefObjectKey="LRP_PickQtyChange"/>
    <OperationCollection>
        <Operation Caption="关闭界面" Key="Close" RefKey="Close"/>
    </OperationCollection>
    <Body PopHeight="600px" PopWidth="1200px">
        <Block>
            <FlexFlowLayoutPanel Key="main">
                <ToolBar Height="pref" Key="main_toolbar">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Height="100%" Key="main_split" Orientation="Vertical">
                    <GridLayoutPanel Caption="查询" Height="pref" Key="first_head" Padding="5px">
                        <Dict BuddyKey="Lab_materialId_h" Enable="false" Caption="物料" ItemKey="LRP_Material" Key="materialId_h" X="1" XSpan="3" Y="0">
                            <Condition ColumnKey="MaterialId" CondSign="=" TableKey="WM_QUANT"/>
                        </Dict>
                        <Label Caption="物料" Key="Lab_materialId_h" X="0" Y="0"/>
                        <Dict AllowMultiSelection="true" BuddyKey="Lab_MaterialStatusId_h" Caption="物料状态" ItemKey="LRP_MaterialStatus" Key="MaterialStatusId_h" X="6" XSpan="3" Y="0">
                            <Condition ColumnKey="MaterialStatusId" CondSign="in" TableKey="WM_QUANT"/>
                        </Dict>
                        <Label Caption="物料状态" Key="Lab_MaterialStatusId_h" X="5" Y="0"/>
                        <Dict BuddyKey="Lab_StoreroomId_h" Caption="仓间" ItemKey="LRP_Storeroom" Key="StoreroomId_h" X="1" XSpan="3" Y="1">
                            <Condition ColumnKey="StoreroomId" CondSign="=" TableKey="WM_QUANT"/>
                            <ItemFilter ItemKey="LRP_Storeroom">
                                <Filter FilterDependency="WarehouseCenterId" Type="FieldValue">
                                    <FilterValue FieldKey="WarehouseCenterId" RefValue="WarehouseCenterId" Type="Field"/>
                                </Filter>
                            </ItemFilter>
                        </Dict>
                        <Label Caption="仓间" Key="Lab_StoreroomId_h" X="0" Y="1"/>
                        <Dict BuddyKey="Lab_StoreareaId_h" Caption="库区" ItemKey="LRP_Storearea" Key="StoreareaId_h" X="6" XSpan="3" Y="1">
                            <Condition ColumnKey="StoreareaId" CondSign="=" TableKey="WM_QUANT"/>
                            <ItemFilter ItemKey="LRP_Storearea">
                                <Filter FilterDependency="StoreroomId_h" Type="FieldValue">
                                    <FilterValue FieldKey="StoreroomId" RefValue="StoreroomId_h" Type="Field"/>
                                </Filter>
                            </ItemFilter>
                        </Dict>
                        <Label Caption="库区" Key="Lab_StoreareaId_h" X="5" Y="1"/>
                        <Dict BuddyKey="Lab_LocationId_h" Caption="储位" ItemKey="LRP_Location" Key="LocationId_h" X="1" XSpan="3" Y="2">
                            <Condition ColumnKey="LocationId" CondSign="=" TableKey="WM_QUANT"/>
                            <ItemFilter ItemKey="LRP_Location">
                                <Filter FilterDependency="StoreareaId_h" Type="FieldValue">
                                    <FilterValue FieldKey="StoreareaId" RefValue="StoreareaId_h" Type="Field"/>
                                </Filter>
                            </ItemFilter>
                        </Dict>
                        <Label Caption="储位" Key="Lab_LocationId_h" X="0" Y="2"/>
                        <TextEditor BuddyKey="Lab_BatchNo_h" Caption="批号" Key="BatchNo_h" X="6" XSpan="3" Y="2">
                            <Condition ColumnKey="BatchNo" CondSign="like" TableKey="WM_QUANT"/>
                        </TextEditor>
                        <Label Caption="批号" Key="Lab_BatchNo_h" X="5" Y="2"/>
                        <Dict BuddyKey="Lab_WarehouseCenterId" Caption="仓储中心" ItemKey="LRP_WarehouseCenter" Key="WarehouseCenterId" Visible="false" X="1" XSpan="3" Y="3">
                            <Condition ColumnKey="WarehouseCenterId" CondSign="=" TableKey="WM_QUANT"/>
                        </Dict>
                        <Label Caption="仓储中心" Key="Lab_WarehouseCenterId" Visible="false" X="0" Y="3"/>
                        <Button Caption="查询" Enable="true" Key="Query" X="10" Y="0">
                            <OnClick>
                                <![CDATA[
								DealCondition();LoadData();ShowData();	
								]]>
                            </OnClick>
                        </Button>
                        <Button Caption="重置" Enable="true" Key="cancle" X="10" Y="1">
                            <OnClick>
                                <![CDATA[
								ResetCondition(); 	
								SetValue("materialId_h",GetPara('Par_MaterialId'));
								//var s = "[[itemKey:LRP_MaterialStatus,oid:"+GetPara('Par_MaterialStatusId')+"]]";
								//SetValue("MaterialStatusId_h",GetPara('Par_MaterialStatusId'));
								SetValue("WarehouseCenterId",GetPara('Par_WarehouseCenterId'));
								SetValue("BatchNo_h",GetPara('Par_BatchNo'));						
								]]>
                            </OnClick>
                        </Button>
                        <RowDefCollection RowGap="8">
                            <RowDef Height="25px"/>
                            <RowDef Height="25px"/>
                            <RowDef Height="25px"/>
                            <RowDef Height="25px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="8">
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="30px"/>
                            <ColumnDef Width="80px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                    <TabPanel Key="Detail">
                        <Grid Caption="存储区库存" Key="Grid0" PageLoadType="UI" PageRowCount="20" NewEmptyRow="false" RowAlterable="false">
                            <GridColumnCollection>
                                <GridColumn Caption="选择" Key="Select" Width="80px"/>
                                <GridColumn Caption="物料" Key="column1" Width="80px" Sortable="true"/>
                                <GridColumn Caption="批号" Key="BatchNo" Visible="ToBool(GetSessionPara('BatchNo_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="生产日期" Key="ManufDate" Visible="ToBool(GetSessionPara('ManufDate_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="失效日期" Key="ExpireDate" Visible="ToBool(GetSessionPara('ExpireDate_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="入库日期" Key="RecvDate" Visible="ToBool(GetSessionPara('RecvDate_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="项目" Key="ProjectId" Visible="ToBool(GetSessionPara('ProjectId_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字符型1" Key="StrUserDef1" Visible="ToBool(GetSessionPara('StrUserDef1_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字符型2" Key="StrUserDef2" Visible="ToBool(GetSessionPara('StrUserDef2_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字符型3" Key="StrUserDef3" Visible="ToBool(GetSessionPara('StrUserDef3_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字符型4" Key="StrUserDef4" Visible="ToBool(GetSessionPara('StrUserDef4_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字符型5" Key="StrUserDef5" Visible="ToBool(GetSessionPara('StrUserDef5_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字典型1" Key="DictUserDef1" Visible="ToBool(GetSessionPara('DictUserDef1_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字典型2" Key="DictUserDef2" Visible="ToBool(GetSessionPara('DictUserDef2_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字典型3" Key="DictUserDef3" Visible="ToBool(GetSessionPara('DictUserDef3_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字典型4" Key="DictUserDef4" Visible="ToBool(GetSessionPara('DictUserDef4_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="字典型5" Key="DictUserDef5" Visible="ToBool(GetSessionPara('DictUserDef5_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="日期型1" Key="DateUserDef1" Visible="ToBool(GetSessionPara('DateUserDef1_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="日期型2" Key="DateUserDef2" Visible="ToBool(GetSessionPara('DateUserDef2_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="数值型1" Key="NumUserDef1" Visible="ToBool(GetSessionPara('NumUserDef1_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="数值型2" Key="NumUserDef2" Visible="ToBool(GetSessionPara('NumUserDef2_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="数值型3" Key="NumUserDef3" Visible="ToBool(GetSessionPara('NumUserDef3_IsShow'))" Width="80px" Sortable="true"/>
                                <GridColumn Caption="添加数量" Key="addQty" Width="80px" Sortable="true"/>
                                <GridColumn Caption="单位" Key="Unit" Width="80px" Sortable="true"/>
                                <GridColumn Caption="在库量" Key="OnhandQty" Width="80px" Sortable="true"/>
                                <GridColumn Caption="分配量" Key="AllocQty" Width="80px" Sortable="true"/>
                                <GridColumn Caption="物料状态" Key="MaterialStatusId" Width="80px" Sortable="true"/>
                                <GridColumn Caption="仓间" Key="StoreroomId" Width="80px" Sortable="true"/>
                                <GridColumn Caption="库区" Key="StoreareaId" Width="80px" Sortable="true"/>
                                <GridColumn Caption="储位" Key="LocationId" Width="80px" Sortable="true"/>
                                <GridColumn Caption="周转容器号" Key="HandingUnitNo" Width="80px" Sortable="true"/>
                                <GridColumn Caption="相关单据明细id" Key="RefLineOID" Visible="false" Width="80px"/>
                            </GridColumnCollection>
                            <GridRowCollection>
                                <GridRow Key="row1" RowHeight="35" TableKey="WM_QUANT">
                                    <GridCell Caption="选择" CellType="CheckBox" Enable="true" IsSelect="true" Key="Select"/>
                                    <GridCell Caption="物料" CellType="Dict" Enable="false" ItemKey="LRP_Material" Key="MaterialId">
                                        <DataBinding ColumnKey="MaterialId"/>
                                    </GridCell>
                                    <GridCell Caption="批号" CellType="TextEditor" Enable="false" Key="BatchNo">
                                        <DataBinding ColumnKey="BatchNo"/>
                                    </GridCell>
                                    <GridCell Caption="生产日期" CellType="DatePicker" OnlyDate="true" Enable="false" Key="ManufDate" Format="yyyy-MM-dd">
                                        <DataBinding ColumnKey="ManufDate"/>
                                    </GridCell>
                                    <GridCell Caption="失效日期" CellType="DatePicker" OnlyDate="true" Enable="false" Key="ExpireDate" Format="yyyy-MM-dd">
                                        <DataBinding ColumnKey="ExpireDate"/>
                                    </GridCell>
                                    <GridCell Caption="入库日期" CellType="DatePicker" OnlyDate="true" Enable="false" Key="RecvDate" Format="yyyy-MM-dd">
                                        <DataBinding ColumnKey="RecvDate"/>
                                    </GridCell>
                                    <GridCell Caption="项目" CellType="Dict" Enable="false" Key="ProjectId" ItemKey="LRP_Project">
                                        <DataBinding ColumnKey="ProjectId"/>
                                    </GridCell>
                                    <GridCell Caption="字符型1" CellType="TextEditor" Enable="false" Key="StrUserDef1">
                                        <DataBinding ColumnKey="StrUserDef1"/>
                                    </GridCell>
                                    <GridCell Caption="字符型2" CellType="TextEditor" Enable="false" Key="StrUserDef2">
                                        <DataBinding ColumnKey="StrUserDef2"/>
                                    </GridCell>
                                    <GridCell Caption="字符型3" CellType="TextEditor" Enable="false" Key="StrUserDef3">
                                        <DataBinding ColumnKey="StrUserDef3"/>
                                    </GridCell>
                                    <GridCell Caption="字符型4" CellType="TextEditor" Enable="false" Key="StrUserDef4">
                                        <DataBinding ColumnKey="StrUserDef4"/>
                                    </GridCell>
                                    <GridCell Caption="字符型5" CellType="TextEditor" Enable="false" Key="StrUserDef5">
                                        <DataBinding ColumnKey="StrUserDef5"/>
                                    </GridCell>
                                    <GridCell Caption="字典型1" CellType="Dict" ItemKeySourceType="Para" ItemKeySource="DictUserItemKey.DictUser1ItemKey" Enable="false" Key="DictUserDef1">
                                        <DataBinding ColumnKey="DictUserDef1"/>
                                    </GridCell>
                                    <GridCell Caption="字典型2" CellType="Dict" ItemKeySourceType="Para" ItemKeySource="DictUserItemKey.DictUser2ItemKey" Enable="false" Key="DictUserDef2">
                                        <DataBinding ColumnKey="DictUserDef2"/>
                                    </GridCell>
                                    <GridCell Caption="字典型3" CellType="Dict" ItemKeySourceType="Para" ItemKeySource="DictUserItemKey.DictUser3ItemKey" Enable="false" Key="DictUserDef3">
                                        <DataBinding ColumnKey="DictUserDef3"/>
                                    </GridCell>
                                    <GridCell Caption="字典型4" CellType="Dict" ItemKeySourceType="Para" ItemKeySource="DictUserItemKey.DictUser4ItemKey" Enable="false" Key="DictUserDef4">
                                        <DataBinding ColumnKey="DictUserDef4"/>
                                    </GridCell>
                                    <GridCell Caption="字典型5" CellType="Dict" ItemKeySourceType="Para" ItemKeySource="DictUserItemKey.DictUser5ItemKey" Enable="false" Key="DictUserDef5">
                                        <DataBinding ColumnKey="DictUserDef5"/>
                                    </GridCell>
                                    <GridCell Caption="日期型1" CellType="DatePicker" Enable="false" Key="DateUserDef1" Format="yyyy-MM-dd" OnlyDate="true">
                                        <DataBinding ColumnKey="DateUserDef1"/>
                                    </GridCell>
                                    <GridCell Caption="日期型2" CellType="DatePicker" Enable="false" Key="DateUserDef2" Format="yyyy-MM-dd" OnlyDate="true">
                                        <DataBinding ColumnKey="DateUserDef2"/>
                                    </GridCell>
                                    <GridCell Caption="数值型1" CellType="NumberEditor" Enable="false" Key="NumUserDef1">
                                        <DataBinding ColumnKey="NumUserDef1"/>
                                    </GridCell>
                                    <GridCell Caption="数值型2" CellType="NumberEditor" Enable="false" Key="NumUserDef2">
                                        <DataBinding ColumnKey="NumUserDef2"/>
                                    </GridCell>
                                    <GridCell Caption="数值型3" CellType="NumberEditor" Enable="false" Key="NumUserDef3">
                                        <DataBinding ColumnKey="NumUserDef3"/>
                                    </GridCell>
                                    <GridCell Caption="添加数量" CellType="NumberEditor" Key="addQty">
                                        <DataBinding ColumnKey="AddQty" CheckRule="addQty&gt;0" ErrorInfo="添加数量大于0"/>
                                    </GridCell>
                                    <GridCell Caption="单位" CellType="TextEditor" Enable="false" Key="BasicUnit">
                                        <DataBinding ColumnKey="BasicUnit"/>
                                    </GridCell>
                                    <GridCell Caption="在库量" CellType="NumberEditor" Enable="false" Key="OnhandQty">
                                        <DataBinding ColumnKey="OnhandQty"/>
                                    </GridCell>
                                    <GridCell Caption="分配量" CellType="NumberEditor" Enable="false" Key="AllocQty">
                                        <DataBinding ColumnKey="AllocQty"/>
                                    </GridCell>
                                    <GridCell Caption="物料状态" CellType="Dict" Enable="false" ItemKey="LRP_MaterialStatus" Key="MaterialStatusId">
                                        <DataBinding ColumnKey="MaterialStatusId"/>
                                    </GridCell>
                                    <GridCell Caption="仓间" CellType="Dict" Enable="false" ItemKey="LRP_Storeroom" Key="StoreroomId">
                                        <DataBinding ColumnKey="StoreroomId"/>
                                    </GridCell>
                                    <GridCell Caption="库区" CellType="Dict" Enable="false" ItemKey="LRP_Storearea" Key="StoreareaId">
                                        <DataBinding ColumnKey="StoreareaId"/>
                                    </GridCell>
                                    <GridCell Caption="储位" CellType="Dict" Enable="false" ItemKey="LRP_Location" Key="LocationId">
                                        <DataBinding ColumnKey="LocationId"/>
                                    </GridCell>
                                    <GridCell Caption="周转容器号" CellType="TextEditor" Enable="false" Key="HandingUnitNo">
                                        <DataBinding ColumnKey="HandingUnitNo"/>
                                    </GridCell>
                                    <GridCell Caption="相关单据明细id" CellType="TextEditor" Enable="false" Key="RefLineOID">
                                        <DataBinding ColumnKey="RefLineOID"/>
                                    </GridCell>
                                </GridRow>
                            </GridRowCollection>
                        </Grid>
                    </TabPanel>
                    <GridLayoutPanel Caption="GridLayoutPanel1" Key="GridLayoutPanel1" Padding="10px">
                        <Button Caption="确定" Key="OK" X="1" Y="0">
                            <OnClick>
                                <![CDATA[
				var flag=0;
				var i=0;
				var select = 0;
				loop"Grid0"(true)
				{	
					if(ToInt(Select)==1){
						flag=flag + 1;
						select = i;
					}
					i = i + 1;
				}
				if(flag==0){Confirm('请选择需要替换的库存明细。','OK','OK:{}');}
				if(flag>1){Confirm('替换的库存明细行数不能超过一条。','OK','OK:{}');}
				if(flag==1){
					SetRowIndex('Grid0', select);
					if(addQty>0){
						if(addQty > OnhandQty)
							{Confirm('替换数量必须小于在库数量。','OK','OK:{}');}
						else{
							var Index = GetPara('PAR_FocusRow');
										
							parent.SetCellValue('Grid0', Index,'Qty',addQty);
							parent.SetCellValue('Grid0', Index,'SrcStoreroomId',StoreroomId);
							parent.SetCellValue('Grid0', Index,'SrcStoreareaId',StoreareaId);
							parent.SetCellValue('Grid0', Index,'SrcLocationId',LocationId);
							parent.SetCellValue('Grid0', Index,'SrcHandingUnitNo',HandingUnitNo);
								
							parent.SetCellValue('Grid0', Index,'SrcBatchNo',BatchNo);
							parent.SetCellValue('Grid0', Index,'SrcManufDate',ManufDate);
							parent.SetCellValue('Grid0', Index,'SrcExpireDate',ExpireDate);
							parent.SetCellValue('Grid0', Index,'SrcRecvDate',RecvDate);
							parent.SetCellValue('Grid0', Index,'SrcProjectId',ProjectId);
							parent.SetCellValue('Grid0', Index,'SrcStrUserDef1',StrUserDef1);
							parent.SetCellValue('Grid0', Index,'SrcStrUserDef2',StrUserDef2);
							parent.SetCellValue('Grid0', Index,'SrcStrUserDef3',StrUserDef3);
							parent.SetCellValue('Grid0', Index,'SrcStrUserDef4',StrUserDef4);
							parent.SetCellValue('Grid0', Index,'SrcStrUserDef5',StrUserDef5);
							parent.SetCellValue('Grid0', Index,'SrcDictUserDef1',DictUserDef1);
							parent.SetCellValue('Grid0', Index,'SrcDictUserDef2',DictUserDef2);
							parent.SetCellValue('Grid0', Index,'SrcDictUserDef3',DictUserDef3);
							parent.SetCellValue('Grid0', Index,'SrcDictUserDef4',DictUserDef4);
							parent.SetCellValue('Grid0', Index,'SrcDictUserDef5',DictUserDef5);
							parent.SetCellValue('Grid0', Index,'SrcDateUserDef1',DateUserDef1);
							parent.SetCellValue('Grid0', Index,'SrcDateUserDef2',DateUserDef2);
							parent.SetCellValue('Grid0', Index,'SrcNumUserDef1',NumUserDef1);
							parent.SetCellValue('Grid0', Index,'SrcNumUserDef2',NumUserDef2);
							parent.SetCellValue('Grid0', Index,'SrcNumUserDef3',NumUserDef3);
							parent.SetCellValue('Grid0', Index,'MaterialUnit',BasicUnit);
							parent.SetCellValue('Grid0', Index,'SrcMaterialStatusId',MaterialStatusId);
							parent.SetCellValue('Grid0', Index,'SrcRefLineOID',RefLineOID);
								
							parent.SetCellValue('Grid0', Index,'DestBatchNo',BatchNo);
							parent.SetCellValue('Grid0', Index,'DestManufDate',ManufDate);
							parent.SetCellValue('Grid0', Index,'DestExpireDate',ExpireDate);
							parent.SetCellValue('Grid0', Index,'DestRecvDate',RecvDate);
							parent.SetCellValue('Grid0', Index,'DestProjectId',ProjectId);
							parent.SetCellValue('Grid0', Index,'DestStrUserDef1',StrUserDef1);
							parent.SetCellValue('Grid0', Index,'DestStrUserDef2',StrUserDef2);
							parent.SetCellValue('Grid0', Index,'DestStrUserDef3',StrUserDef3);
							parent.SetCellValue('Grid0', Index,'DestStrUserDef4',StrUserDef4);
							parent.SetCellValue('Grid0', Index,'DestStrUserDef5',StrUserDef5);
							parent.SetCellValue('Grid0', Index,'DestDictUserDef1',DictUserDef1);
							parent.SetCellValue('Grid0', Index,'DestDictUserDef2',DictUserDef2);
							parent.SetCellValue('Grid0', Index,'DestDictUserDef3',DictUserDef3);
							parent.SetCellValue('Grid0', Index,'DestDictUserDef4',DictUserDef4);
							parent.SetCellValue('Grid0', Index,'DestDictUserDef5',DictUserDef5);
							parent.SetCellValue('Grid0', Index,'DestDateUserDef1',DateUserDef1);
							parent.SetCellValue('Grid0', Index,'DestDateUserDef2',DateUserDef2);
							parent.SetCellValue('Grid0', Index,'DestNumUserDef1',NumUserDef1);
							parent.SetCellValue('Grid0', Index,'DestNumUserDef2',NumUserDef2);
							parent.SetCellValue('Grid0', Index,'DestNumUserDef3',NumUserDef3);
							parent.SetCellValue('Grid0', Index,'DestMaterialStatusId',MaterialStatusId);
							if(Parent.GetPara("FormKey")=="V_Tx202"){
								Parent.RefreshDetailSum();
							}
							Close();							
						}
					}
					else
						{Confirm('替换数量必须大于0。','OK','OK:{}');}
				}
			      ]]>
                            </OnClick>
                        </Button>
                        <Button Caption="取消" Key="Cancel" X="2" Y="0">
                            <OnClick>
                                <![CDATA[Close();]]>
                            </OnClick>
                        </Button>
                        <Label Caption="货主" Key="Par_OwnerId" Visible="false" X="0" Y="0"/>
                        <Label Caption="仓储中心" Key="Par_WarehouseCenterId" Visible="false" X="0" Y="0"/>
                        <Label Caption="物料" Key="Par_MaterialId" Visible="false" X="0" Y="0"/>
                        <Label Caption="批号" Key="Par_BatchNo" Visible="false" X="0" Y="0"/>
                        <Label Caption="生产日期" Key="Par_ManufDate" Visible="false" X="0" Y="0"/>
                        <Label Caption="失效日期" Key="Par_ExpireDate" Visible="false" X="0" Y="0"/>
                        <Label Caption="入库日期" Key="Par_RecvDate" Visible="false" X="0" Y="0"/>
                        <Label Caption="项目" Key="Par_ProjectId" Visible="false" X="0" Y="0"/>
                        <Label Caption="字符型1" Key="Par_StrUserDef1" Visible="false" X="0" Y="0"/>
                        <Label Caption="字符型2" Key="Par_StrUserDef2" Visible="false" X="0" Y="0"/>
                        <Label Caption="字符型3" Key="Par_StrUserDef3" Visible="false" X="0" Y="0"/>
                        <Label Caption="字符型4" Key="Par_StrUserDef4" Visible="false" X="0" Y="0"/>
                        <Label Caption="字符型5" Key="Par_StrUserDef5" Visible="false" X="0" Y="0"/>
                        <Label Caption="字典型1" Key="Par_DictUserDef1" Visible="false" X="0" Y="0"/>
                        <Label Caption="字典型2" Key="Par_DictUserDef2" Visible="false" X="0" Y="0"/>
                        <Label Caption="字典型3" Key="Par_DictUserDef3" Visible="false" X="0" Y="0"/>
                        <Label Caption="字典型4" Key="Par_DictUserDef4" Visible="false" X="0" Y="0"/>
                        <Label Caption="字典型5" Key="Par_DictUserDef5" Visible="false" X="0" Y="0"/>
                        <Label Caption="日期型1" Key="Par_DateUserDef1" Visible="false" X="0" Y="0"/>
                        <Label Caption="日期型2" Key="Par_DateUserDef2" Visible="false" X="0" Y="0"/>
                        <Label Caption="数值型1" Key="Par_NumUserDef1" Visible="false" X="0" Y="0"/>
                        <Label Caption="数值型2" Key="Par_NumUserDef2" Visible="false" X="0" Y="0"/>
                        <Label Caption="数值型3" Key="Par_NumUserDef3" Visible="false" X="0" Y="0"/>
                        <Label Caption="数值型3" Key="Par_MaterialStatusId" Visible="false" X="0" Y="0"/>
                        <RowDefCollection RowGap="8">
                            <RowDef Height="30px"/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="8">
                            <ColumnDef Width="100%"/>
                            <ColumnDef Width="80px"/>
                            <ColumnDef Width="80px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                    <SplitSize Size="150px"/>
                    <SplitSize Size="100%"/>
                    <SplitSize Size="50px"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
    <OnLoad>
        <![CDATA[
		SetColumnCaption("Grid0","BatchNo",ToString(GetSessionPara('BatchNo_Name')));
		SetColumnCaption("Grid0","ManufDate",ToString(GetSessionPara('ManufDate_Name')));
		SetColumnCaption("Grid0","ExpireDate",ToString(GetSessionPara('ExpireDate_Name')));
		SetColumnCaption("Grid0","RecvDate",ToString(GetSessionPara('RecvDate_Name')));
		SetColumnCaption("Grid0","ProjectId",ToString(GetSessionPara('ProjectId_Name')));
		SetColumnCaption("Grid0","StrUserDef1",ToString(GetSessionPara('StrUserDef1_Name')));
		SetColumnCaption("Grid0","StrUserDef2",ToString(GetSessionPara('StrUserDef2_Name')));
		SetColumnCaption("Grid0","StrUserDef3",ToString(GetSessionPara('StrUserDef3_Name')));
		SetColumnCaption("Grid0","StrUserDef4",ToString(GetSessionPara('StrUserDef4_Name')));
		SetColumnCaption("Grid0","StrUserDef5",ToString(GetSessionPara('StrUserDef5_Name')));
		SetColumnCaption("Grid0","DictUserDef1",ToString(GetSessionPara('DictUserDef1_Name')));
		SetColumnCaption("Grid0","DictUserDef2",ToString(GetSessionPara('DictUserDef2_Name')));
		SetColumnCaption("Grid0","DictUserDef3",ToString(GetSessionPara('DictUserDef3_Name')));
		SetColumnCaption("Grid0","DictUserDef4",ToString(GetSessionPara('DictUserDef4_Name')));
		SetColumnCaption("Grid0","DictUserDef5",ToString(GetSessionPara('DictUserDef5_Name')));
		SetColumnCaption("Grid0","DateUserDef1",ToString(GetSessionPara('DateUserDef1_Name')));
		SetColumnCaption("Grid0","DateUserDef2",ToString(GetSessionPara('DateUserDef2_Name')));
		SetColumnCaption("Grid0","NumUserDef1",ToString(GetSessionPara('NumUserDef1_Name')));
		SetColumnCaption("Grid0","NumUserDef2",ToString(GetSessionPara('NumUserDef2_Name')));
		SetColumnCaption("Grid0","NumUserDef3",ToString(GetSessionPara('NumUserDef3_Name')));
		
		
		SetValue("materialId_h",GetPara('Par_MaterialId'));
		//SetValue("MaterialStatusId_h",GetPara('Par_MaterialStatusId'));
		SetValue("WarehouseCenterId",GetPara('Par_WarehouseCenterId'));
		if(GetPara('Par_BatchNo') != '*'){
			SetValue("BatchNo_h",GetPara('Par_BatchNo'));
		}
		
		SetValue("Par_OwnerId",GetPara('Par_OwnerId'));
		SetValue("Par_WarehouseCenterId",GetPara('Par_WarehouseCenterId'));
		SetValue("Par_MaterialId",GetPara('Par_MaterialId'));
		SetValue("Par_BatchNo",GetPara('Par_BatchNo'));
		SetValue("Par_ManufDate",GetPara('Par_ManufDate'));
		SetValue("Par_ExpireDate",GetPara('Par_ExpireDate'));
		SetValue("Par_RecvDate",GetPara('Par_RecvDate'));
		SetValue("Par_ProjectId",GetPara('Par_ProjectId'));
		SetValue("Par_StrUserDef1",GetPara('Par_StrUserDef1'));
		SetValue("Par_StrUserDef2",GetPara('Par_StrUserDef2'));
		SetValue("Par_StrUserDef3",GetPara('Par_StrUserDef3'));
		SetValue("Par_StrUserDef4",GetPara('Par_StrUserDef4'));
		SetValue("Par_StrUserDef5",GetPara('Par_StrUserDef5'));
		SetValue("Par_DictUserDef1",0);
		SetValue("Par_DictUserDef2",0);
		SetValue("Par_DictUserDef3",0);
		SetValue("Par_DictUserDef4",0);
		SetValue("Par_DictUserDef5",0);
		SetValue("Par_DateUserDef1",GetPara('Par_DateUserDef1'));
		SetValue("Par_DateUserDef2",GetPara('Par_DateUserDef2'));
		SetValue("Par_NumUserDef1",GetPara('Par_NumUserDef1'));
		SetValue("Par_NumUserDef2",GetPara('Par_NumUserDef2'));
		SetValue("Par_NumUserDef3",GetPara('Par_NumUserDef3'));
		SetValue("Par_MaterialStatusId",GetPara('Par_MaterialStatusId'));
		//LoadData();ShowData();
	]]>
    </OnLoad>
    <FormParaCollection>
        <FormPara Key="Par_WarehouseCenterId" Type="Formula" Formula="GetValue({Par_WarehouseCenterId})"/>
        <FormPara Key="Par_MaterialId" Type="Formula" Formula="GetValue({Par_MaterialId})"/>
        <FormPara Key="Par_OwnerId" Type="Formula" Formula="GetValue({Par_OwnerId})"/>
    </FormParaCollection>
</Form>
