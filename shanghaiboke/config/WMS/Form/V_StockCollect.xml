<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="V_StockCollect" Caption="库存汇总查询" FormType="Report">
    <DataSource>
        <DataObject Key="StockCollect" Caption="库存汇总查询">
            <TableCollection>
                <Table Key="LRP_QUANT_S" Caption="存储区库存" TableMode="Detail" SourceType="Query">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="WarehouseCenterId" Caption="仓储中心" DataType="Long"/>
                    <Column Key="OwnerId" Caption="货主" DataType="Long"/>
                    <Column Key="MaterialId" Caption="物料" DataType="Long"/>
                    <Column Key="MaterialStatusId" Caption="物料状态" DataType="Long"/>
                    <Column Key="OnhandQty" Caption="在库量" DataType="Numeric" Precision="16" Scale="2"/>
                    <Column Key="BasicUnit" Caption="基本单位" DataType="Varchar"/>
                    <Statement>
                        <![CDATA[select * from (select q.WarehouseCenterId,q.OwnerId,q.MaterialId,q.MaterialStatusId,sum(q.OnhandQty) as OnhandQty,m.BasicUnit 
from Lrp_quant q join LRP_Storearea s on q.StoreareaId=s.oid join lrp_MATERIAL m on q.MaterialId=m.OID 
where q.OnhandQty>0 and s.IsRecvArea=0 and s.IsShipArea=0 and s.IsSampleTestArea=0 and s.IsKittingArea=0 group by q.WarehouseCenterId,q.OwnerId,
q.MaterialId,q.MaterialStatusId,m.BasicUnit)a]]>
                    </Statement>
                </Table>
                <Table Key="IsRecvArea" Caption="收货区库存" TableMode="Detail" SourceType="Query">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="WarehouseCenterId" Caption="仓储中心" DataType="Long"/>
                    <Column Key="OwnerId" Caption="货主" DataType="Long"/>
                    <Column Key="MaterialId" Caption="物料" DataType="Long"/>
                    <Column Key="MaterialStatusId" Caption="物料状态" DataType="Long"/>
                    <Column Key="OnhandQty" Caption="在库量" DataType="Numeric" Precision="16" Scale="2"/>
                    <Column Key="BasicUnit" Caption="基本单位" DataType="Varchar"/>
                    <Statement>
                        <![CDATA[select * from (select q.WarehouseCenterId,q.OwnerId,q.MaterialId,q.MaterialStatusId,sum(q.OnhandQty) as OnhandQty,m.BasicUnit 
from Lrp_quant q join LRP_Storearea s on q.StoreareaId=s.oid join lrp_MATERIAL m on q.MaterialId=m.OID 
where q.OnhandQty>0 and s.IsRecvArea=1 group by q.WarehouseCenterId,q.OwnerId,
q.MaterialId,q.MaterialStatusId,m.BasicUnit)a]]>
                    </Statement>
                </Table>
                <Table Key="IsShipArea" Caption="发货区库存" TableMode="Detail" SourceType="Query">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="WarehouseCenterId" Caption="仓储中心" DataType="Long"/>
                    <Column Key="OwnerId" Caption="货主" DataType="Long"/>
                    <Column Key="MaterialId" Caption="物料" DataType="Long"/>
                    <Column Key="MaterialStatusId" Caption="物料状态" DataType="Long"/>
                    <Column Key="OnhandQty" Caption="在库量" DataType="Numeric" Precision="16" Scale="2"/>
                    <Column Key="BasicUnit" Caption="基本单位" DataType="Varchar"/>
                    <Statement>
                        <![CDATA[select * from (select q.WarehouseCenterId,q.OwnerId,q.MaterialId,q.MaterialStatusId,sum(q.OnhandQty) as OnhandQty,m.BasicUnit 
from Lrp_quant q join LRP_Storearea s on q.StoreareaId=s.oid join lrp_MATERIAL m on q.MaterialId=m.OID 
where q.OnhandQty>0 and s.IsShipArea=1 group by q.WarehouseCenterId,q.OwnerId,
q.MaterialId,q.MaterialStatusId,m.BasicUnit)a]]>
                    </Statement>
                </Table>
                <Table Key="IsSampleTestArea" Caption="样品检验区库存" TableMode="Detail" SourceType="Query">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="WarehouseCenterId" Caption="仓储中心" DataType="Long"/>
                    <Column Key="OwnerId" Caption="货主" DataType="Long"/>
                    <Column Key="MaterialId" Caption="物料" DataType="Long"/>
                    <Column Key="MaterialStatusId" Caption="物料状态" DataType="Long"/>
                    <Column Key="OnhandQty" Caption="在库量" DataType="Numeric" Precision="16" Scale="2"/>
                    <Column Key="BasicUnit" Caption="基本单位" DataType="Varchar"/>
                    <Statement>
                        <![CDATA[select * from (select q.WarehouseCenterId,q.OwnerId,q.MaterialId,q.MaterialStatusId,sum(q.OnhandQty) as OnhandQty,m.BasicUnit 
from Lrp_quant q join LRP_Storearea s on q.StoreareaId=s.oid join lrp_MATERIAL m on q.MaterialId=m.OID 
where q.OnhandQty>0 and s.IsSampleTestArea=1 group by q.WarehouseCenterId,q.OwnerId,
q.MaterialId,q.MaterialStatusId,m.BasicUnit)a]]>
                    </Statement>
                </Table>
                <Table Key="IsKittingArea" Caption="加工区库存" TableMode="Detail" SourceType="Query">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="WarehouseCenterId" Caption="仓储中心" DataType="Long"/>
                    <Column Key="OwnerId" Caption="货主" DataType="Long"/>
                    <Column Key="MaterialId" Caption="物料" DataType="Long"/>
                    <Column Key="MaterialStatusId" Caption="物料状态" DataType="Long"/>
                    <Column Key="OnhandQty" Caption="在库量" DataType="Numeric" Precision="16" Scale="2"/>
                    <Column Key="BasicUnit" Caption="基本单位" DataType="Varchar"/>
                    <Statement>
                        <![CDATA[select * from (select q.WarehouseCenterId,q.OwnerId,q.MaterialId,q.MaterialStatusId,sum(q.OnhandQty) as OnhandQty,m.BasicUnit 
from Lrp_quant q join LRP_Storearea s on q.StoreareaId=s.oid join lrp_MATERIAL m on q.MaterialId=m.OID 
where q.OnhandQty>0 and s.IsKittingArea=1 group by q.WarehouseCenterId,q.OwnerId,
q.MaterialId,q.MaterialStatusId,m.BasicUnit)a]]>
                    </Statement>
                </Table>
            </TableCollection>
            <OIDFilter/>
        </DataObject>
    </DataSource>
    <OperationCollection>
        <Operation Key="Close" Caption="关闭" RefKey="Close"/>
    </OperationCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="root" Caption="根面板">
                <ToolBar Key="ToolBar1" Height="pref" Caption="ToolBar1">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Height="100%" Key="main_split" Orientation="Vertical">
                    <GridLayoutPanel Key="first_head" Padding="5px" Height="pref" Caption="基本信息">
                        <Dict AllowMultiSelection="true" Key="WarehouseCenterId" Caption="仓储中心" BuddyKey="Lab_WarehouseCenterId" X="1" Y="0" XSpan="3" ItemKey="LRP_WarehouseCenter">
                            <Condition CondSign="in">
                                <ConditionTarget TableKey="LRP_QUANT_S" ColumnKey="WarehouseCenterId"/>
                                <ConditionTarget TableKey="IsRecvArea" ColumnKey="WarehouseCenterId"/>
                                <ConditionTarget TableKey="IsShipArea" ColumnKey="WarehouseCenterId"/>
                                <ConditionTarget TableKey="IsSampleTestArea" ColumnKey="WarehouseCenterId"/>
                                <ConditionTarget TableKey="IsKittingArea" ColumnKey="WarehouseCenterId"/>
                            </Condition>
                        </Dict>
                        <Label Key="Lab_WarehouseCenterId" Caption="仓储中心" X="0" Y="0"/>
                        <Dict AllowMultiSelection="true" Key="OwnerId" Caption="货主" BuddyKey="Lab_OwnerId" X="6" Y="0" XSpan="3" ItemKey="LRP_Owner">
                            <Condition CondSign="in">
                                <ConditionTarget TableKey="LRP_QUANT_S" ColumnKey="OwnerId"/>
                                <ConditionTarget TableKey="IsRecvArea" ColumnKey="OwnerId"/>
                                <ConditionTarget TableKey="IsShipArea" ColumnKey="OwnerId"/>
                                <ConditionTarget TableKey="IsSampleTestArea" ColumnKey="OwnerId"/>
                                <ConditionTarget TableKey="IsKittingArea" ColumnKey="OwnerId"/>
                            </Condition>
                        </Dict>
                        <Label Key="Lab_OwnerId" Caption="货主" X="5" Y="0"/>
                        <Dict Key="MaterialId" Caption="物料" BuddyKey="Lab_MaterialId" X="1" Y="1" XSpan="3" ItemKey="LRP_Material">
                            <Condition CondSign="=">
                                <ConditionTarget TableKey="LRP_QUANT_S" ColumnKey="MaterialId"/>
                                <ConditionTarget TableKey="IsRecvArea" ColumnKey="MaterialId"/>
                                <ConditionTarget TableKey="IsShipArea" ColumnKey="MaterialId"/>
                                <ConditionTarget TableKey="IsSampleTestArea" ColumnKey="MaterialId"/>
                                <ConditionTarget TableKey="IsKittingArea" ColumnKey="MaterialId"/>
                            </Condition>
                        </Dict>
                        <Label Key="Lab_MaterialId" Caption="物料" X="0" Y="1"/>
                        <Dict AllowMultiSelection="true" Key="MaterialStatusId" Caption="物料状态" BuddyKey="Lab_MaterialStatusId" X="6" Y="1" XSpan="3" ItemKey="LRP_MaterialStatus">
                            <Condition CondSign="in">
                                <ConditionTarget TableKey="LRP_QUANT_S" ColumnKey="MaterialStatusId"/>
                                <ConditionTarget TableKey="IsRecvArea" ColumnKey="MaterialStatusId"/>
                                <ConditionTarget TableKey="IsShipArea" ColumnKey="MaterialStatusId"/>
                                <ConditionTarget TableKey="IsSampleTestArea" ColumnKey="MaterialStatusId"/>
                                <ConditionTarget TableKey="IsKittingArea" ColumnKey="MaterialStatusId"/>
                            </Condition>
                        </Dict>
                        <Label Key="Lab_MaterialStatusId" Caption="物料状态" X="5" Y="1"/>
                        <Button Key="Query" Caption="查询" X="10" Y="0" Enable="true">
                            <OnClick>
                                <![CDATA[
								DealCondition();LoadData();ShowData();	
								]]>
                            </OnClick>
                        </Button>
                        <Button Key="cancel" Caption="重置" X="10" Y="1" Enable="true">
                            <OnClick>
                                <![CDATA[
								ResetCondition();
								]]>
                            </OnClick>
                        </Button>
                        <RowDefCollection RowGap="8" RowHeight="30">
                            <RowDef/>
                            <RowDef/>
                            <RowDef/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="8">
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="30px"/>
                            <ColumnDef Width="80px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                    <TabPanel Caption="TabPanel1" Key="TabPanel1">
                        <ListView Caption="存储区库存" Key="ListView0" PageLoadType="DB" TableKey="LRP_QUANT_S">
                            <ListViewColumnCollection>
                                <ListViewColumn Key="V_WarehouseCenterId" Caption="仓储中心" ColumnType="Dict" DataColumnKey="WarehouseCenterId" ItemKey="LRP_WarehouseCenter"/>
                                <ListViewColumn Key="V_OwnerId" Caption="货主" ColumnType="Dict" DataColumnKey="OwnerId" ItemKey="LRP_Owner"/>
                                <ListViewColumn Key="V_MaterialId" Caption="物料" ColumnType="Dict" DataColumnKey="MaterialId" ItemKey="LRP_Material"/>
                                <ListViewColumn Key="V_MaterialStatusId" Caption="物料状态" ColumnType="Dict" DataColumnKey="MaterialStatusId" ItemKey="LRP_MaterialStatus"/>
                                <ListViewColumn Key="OnhandQty" Caption="在库量" ColumnType="NumberEditor" DataColumnKey="OnhandQty"/>
                                <ListViewColumn Key="V_BasicUnit" Caption="基本单位" ColumnType="TextEditor" DataColumnKey="BasicUnit"/>
                            </ListViewColumnCollection>
                        </ListView>
                        <ListView Caption="收货区库存" Key="ListView1" PageLoadType="DB" TableKey="IsRecvArea">
                            <ListViewColumnCollection>
                                <ListViewColumn Key="V_WarehouseCenterId_02" Caption="仓储中心" ColumnType="Dict" DataColumnKey="WarehouseCenterId" ItemKey="LRP_WarehouseCenter"/>
                                <ListViewColumn Key="V_OwnerId_02" Caption="货主" ColumnType="Dict" DataColumnKey="OwnerId" ItemKey="LRP_Owner"/>
                                <ListViewColumn Key="V_MaterialId_02" Caption="物料" ColumnType="Dict" DataColumnKey="MaterialId" ItemKey="LRP_Material"/>
                                <ListViewColumn Key="V_MaterialStatusId_02" Caption="物料状态" ColumnType="Dict" DataColumnKey="MaterialStatusId" ItemKey="LRP_MaterialStatus"/>
                                <ListViewColumn Key="OnhandQty_02" Caption="在库量" ColumnType="NumberEditor" DataColumnKey="OnhandQty"/>
                                <ListViewColumn Key="V_BasicUnit_02" Caption="基本单位" ColumnType="TextEditor" DataColumnKey="BasicUnit"/>
                            </ListViewColumnCollection>
                        </ListView>
                        <ListView Caption="发货区库存" Key="ListView2" PageLoadType="DB" TableKey="IsShipArea">
                            <ListViewColumnCollection>
                                <ListViewColumn Key="V_WarehouseCenterId_03" Caption="仓储中心" ColumnType="Dict" DataColumnKey="WarehouseCenterId" ItemKey="LRP_WarehouseCenter"/>
                                <ListViewColumn Key="V_OwnerId_03" Caption="货主" ColumnType="Dict" DataColumnKey="OwnerId" ItemKey="LRP_Owner"/>
                                <ListViewColumn Key="V_MaterialId_03" Caption="物料" ColumnType="Dict" DataColumnKey="MaterialId" ItemKey="LRP_Material"/>
                                <ListViewColumn Key="V_MaterialStatusId_03" Caption="物料状态" ColumnType="Dict" DataColumnKey="MaterialStatusId" ItemKey="LRP_MaterialStatus"/>
                                <ListViewColumn Key="OnhandQty_03" Caption="在库量" ColumnType="NumberEditor" DataColumnKey="OnhandQty"/>
                                <ListViewColumn Key="V_BasicUnit_03" Caption="基本单位" ColumnType="TextEditor" DataColumnKey="BasicUnit"/>
                            </ListViewColumnCollection>
                        </ListView>
                        <ListView Caption="样品检验区库存" Key="ListView3" PageLoadType="DB" TableKey="IsSampleTestArea">
                            <ListViewColumnCollection>
                                <ListViewColumn Key="V_WarehouseCenterId_04" Caption="仓储中心" ColumnType="Dict" DataColumnKey="WarehouseCenterId" ItemKey="LRP_WarehouseCenter"/>
                                <ListViewColumn Key="V_OwnerId_04" Caption="货主" ColumnType="Dict" DataColumnKey="OwnerId" ItemKey="LRP_Owner"/>
                                <ListViewColumn Key="V_MaterialId_04" Caption="物料" ColumnType="Dict" DataColumnKey="MaterialId" ItemKey="LRP_Material"/>
                                <ListViewColumn Key="V_MaterialStatusId_04" Caption="物料状态" ColumnType="Dict" DataColumnKey="MaterialStatusId" ItemKey="LRP_MaterialStatus"/>
                                <ListViewColumn Key="OnhandQty_04" Caption="在库量" ColumnType="NumberEditor" DataColumnKey="OnhandQty"/>
                                <ListViewColumn Key="V_BasicUnit_04" Caption="基本单位" ColumnType="TextEditor" DataColumnKey="BasicUnit"/>
                            </ListViewColumnCollection>
                        </ListView>
                        <ListView Caption="加工区库存" Key="ListView4" PageLoadType="DB" TableKey="IsKittingArea">
                            <ListViewColumnCollection>
                                <ListViewColumn Key="V_WarehouseCenterId_05" Caption="仓储中心" ColumnType="Dict" DataColumnKey="WarehouseCenterId" ItemKey="LRP_WarehouseCenter"/>
                                <ListViewColumn Key="V_OwnerId_05" Caption="货主" ColumnType="Dict" DataColumnKey="OwnerId" ItemKey="LRP_Owner"/>
                                <ListViewColumn Key="V_MaterialId_05" Caption="物料" ColumnType="Dict" DataColumnKey="MaterialId" ItemKey="LRP_Material"/>
                                <ListViewColumn Key="V_MaterialStatusId_05" Caption="物料状态" ColumnType="Dict" DataColumnKey="MaterialStatusId" ItemKey="LRP_MaterialStatus"/>
                                <ListViewColumn Key="OnhandQty_05" Caption="在库量" ColumnType="NumberEditor" DataColumnKey="OnhandQty"/>
                                <ListViewColumn Key="V_BasicUnit_05" Caption="基本单位" ColumnType="TextEditor" DataColumnKey="BasicUnit"/>
                            </ListViewColumnCollection>
                        </ListView>
                    </TabPanel>
                    <SplitSize Size="90px"/>
                    <SplitSize Size="100%"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
</Form>
