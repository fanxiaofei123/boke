<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="V_CarrierBiddingQuery" Caption="承运商竞价查询" FormType="Report">
    <DataSource>
        <DataObject Key="TransOrderQuery" Caption="承运商竞价查询" PrimaryTableKey="LRP_TransportOrderBiding_L">
            <TableCollection>
                <Table Key="LRP_TransportOrderBiding_L" Caption="承运商竞价" TableMode="Detail" SourceType="Query" Persist="false">
                    <Column Caption="承运商" DataType="Long" Key="CarrierId"/>
                    <Column Caption="竞价价格" DataType="Numeric" Key="BidingPrice" Precision="18" Scale="6"/>
                    <Column Caption="备注" DataType="Varchar" Key="Remark" Length="200"/>
                    <Column Caption="竞价状态" DataType="Integer" Key="BidingStatus"/>
                    <Column Caption="订单号" DataType="Varchar" Key="No" Length="100" SortType="Desc"/>
                    <Column Caption="竞价模式" DataType="Integer" Key="BidingType"/>
                    <ParameterCollection>
                        <Parameter DataType="Long" Description="当前登录操作员oid" Formula="GetOperator()"/>
                        <Parameter DataType="Long" Description="当前登录操作员oid" Formula="GetOperator()"/>
                    </ParameterCollection>
                    <Statement>
                        <![CDATA[select * from (select h.CarrierId,h.GrabPrice as BidingPrice,'' as Remark,0 as BidingStatus,h.No,BidingType from LRP_TransportOrder_H h join  Sys_Operator o on h.CarrierId=o.CarrierId where h.BidingType=2 and h.CarrierId>0 and h.GrabPrice>0 and o.oid=? union select l.CarrierId,l.BidingPrice,l.Remark,l.BidingStatus,h.No,h.BidingType from LRP_TransportOrderBiding_L l join LRP_TransportOrder_H h on l.soid=h.oid join Sys_Operator o on l.CarrierId=o.CarrierId and o.oid=?)a]]>
                    </Statement>
                </Table>
            </TableCollection>
            <OIDFilter/>
        </DataObject>
    </DataSource>
    <OperationCollection>
        <Operation Key="Close" Caption="关闭" RefKey="Close"/>
    </OperationCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="main">
                <ToolBar Height="pref" Key="main_toolbar">
                    <ToolBarItemCollection/>
                </ToolBar>
                <SplitPanel Key="main_split" Orientation="Vertical" Height="100%">
                    <GridLayoutPanel Key="query" Height="100%" Padding="5px" Caption="查询字段">
                        <Label Key="L_No" Caption="订单号" X="5" Y="0"/>
                        <TextEditor Key="No" Caption="订单号" BuddyKey="L_No" X="6" Y="0" XSpan="3">
                            <Condition ColumnKey="No" TableKey="LRP_TransportOrderBiding_L" CondSign="like"/>
                        </TextEditor>
                        <Label Key="L_BidingType" Caption="竞价模式" X="0" Y="1"/>
                        <CheckListBox Key="BidingType" Caption="状态" BuddyKey="L_BidingType" X="1" Y="1" XSpan="3">
                            <Condition ColumnKey="BidingType" TableKey="LRP_TransportOrderBiding_L" CondSign="in"/>
                            <Item Caption="抢单" Key="gab" Value="2"/>
                            <Item Caption="竞价" Key="bid" Value="1"/>
                        </CheckListBox>
                        <Label Key="L_BidingStatus" Caption="竞价状态" X="0" Y="0"/>
                        <CheckListBox Key="BidingStatus" Caption="竞价状态" BuddyKey="L_BidingType" X="1" Y="0" XSpan="3">
                            <Condition ColumnKey="BidingStatus" TableKey="LRP_TransportOrderBiding_L" CondSign="in"/>
                            <Item Caption="竞价中" Key="wait" Value="0"/>
                            <Item Caption="竞价成功" Key="success" Value="1"/>
                            <Item Caption="竞价作废" Key="cancel" Value="2"/>
                        </CheckListBox>
                        <Button Key="Query" Caption="查询" X="10" Y="0" Enable="true">
                            <OnClick>
                                <![CDATA[							
                                       DealCondition();LoadData();ShowData();	
								]]>
                            </OnClick>
                        </Button>
                        <Button Key="cancel" Caption="重置" X="10" Y="1" Enable="true">
                            <OnClick>
                                <![CDATA[
								ResetCondition();						
								]]>
                            </OnClick>
                        </Button>
                        <RowDefCollection RowHeight="25" RowGap="5">
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="5">
                            <ColumnDef Width="99px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="55px"/>
                            <ColumnDef Width="25%"/>
                            <ColumnDef Width="30px"/>
                            <ColumnDef Width="80px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                    <ListView Key="list" TableKey="LRP_TransportOrderBiding_L" PageLoadType="DB" RowAlterable="false">
                        <ListViewColumnCollection>
                            <ListViewColumn Key="No_LV" Caption="运输订单号" ColumnType="TextEditor" DataColumnKey="No" Width="160px"/>
                            <ListViewColumn Key="BidingType_LV" Caption="竞价模式" ColumnType="ComboBox" DataColumnKey="BidingType">
                                <Item Caption="抢单" Key="gab" Value="2"/>
                                <Item Caption="竞价" Key="bid" Value="1"/>
                            </ListViewColumn>
                            <ListViewColumn Key="BidingPrice_LV" Caption="价格" ColumnType="NumberEditor" DataColumnKey="BidingPrice"/>
                            <ListViewColumn Key="BidingStatus_LV" Caption="竞价状态" ColumnType="ComboBox" DataColumnKey="BidingStatus">
                                <Item Caption="竞价中" Key="wait" Value="0"/>
                                <Item Caption="竞价成功" Key="success" Value="1"/>
                                <Item Caption="竞价作废" Key="cancel" Value="2"/>
                            </ListViewColumn>
                            <ListViewColumn Key="Remark_LV" Caption="备注" ColumnType="TextEditor" DataColumnKey="Remark"/>
                        </ListViewColumnCollection>
                    </ListView>
                    <SplitSize Size="75px"/>
                    <SplitSize Size="100%"/>
                </SplitPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
</Form>
