<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="Tx301Order" HasNavigationBar="false">
    <DataSource RefObjectKey="LRP_WMTx"/>
    <Body>
        <Block>
            <GridLayoutPanel Key="root">
                <Format BackColor="#f1f3f8"/>
                <LinearLayoutPanel Caption="Title3" Key="Title" Orientation="Horizontal" X="0" Y="0">
                    <Format BackColor="#f14c52"/>
                    <Button Key="Cancel" Caption="取消" Enable="True" Height="auto" Width="60px">
                        <Format BackColor="#f14c52" ForeColor="#ffffff" HAlign="Left">
                            <Font Size="16"/>
                        </Format>
                        <OnClick>
                            <![CDATA[
									ShowConfirm('是否放弃本次移位？', 'YES_NO', 
										{
											YES: {
													Close();
												}, 
											NO: {} 
										}
												)
								]]>
                        </OnClick>
                    </Button>
                    <Label Key="TitleCenter" Caption="移位" Height="auto" Weight="1.0">
                        <Format ForeColor="#ffffff" HAlign="Center">
                            <Font Size="20"/>
                        </Format>
                    </Label>
                    <Button Key="Comfirm" Caption="完成" Enable="True" Height="auto" Width="60px">
                        <Format BackColor="#f14c52" ForeColor="#ffffff" HAlign="Right">
                            <Font Size="16"/>
                        </Format>
                        <OnClick>
                            <![CDATA[
								SetValue('Status',900);
								SetValue('FinishDateTime',ServerDate());
								var count=GetRowCount('list');
								var i=0;
								while(i<count){
									SetCellValue('list',i,'Status_L',90);
									i=i+1;
								}
								SaveData();Close();
									]]>
                        </OnClick>
                    </Button>
                </LinearLayoutPanel>
                <TableView Key="locationquery_table" X="0" Y="1">
                    <Format BackColor="#f1f3f8"/>
                    <TableRowCollection>
                        <TableRow Key="r1" SeparatorStyle="solid solid solid none" SeparatorColor="#dde0e7" BottomMargin="20px">
                            <LinearLayoutPanel Key="Material_panel" Height="50px" Orientation="Horizontal">
                                <TextEditor Key="Material_code" Caption="扫描物料条码" PromptText="扫描物料条码" Enable="true" Weight="1.0" Width="auto" BorderRadius="4" BorderColor="#dde0e7" HasBorder="true" Height="auto">
                                    <KeyEnter>
                                        <![CDATA[
										if(Material_code==''){
											return true;
										}
										var count=GetRowCount('list');
										var i=0;
										var flag=false;
										while(i<count){
											if(GetCellValue('list',i,'Materialcode')==Material_code){
												SetFocusRow('list',i);
												SetRowIndex('list',i);
												ScrollTo('list',i);
												flag=true;
												break;
											}
											i=i+1;
										}
										if(flag==false){
											ShowToast("移位明细中找不到该条码物料。");
										}
										SetFocus('Material_code');
									  ]]>
                                    </KeyEnter>
                                </TextEditor>
                                <Button Key="query_btn2" Icon="12.png" OnlyIcon="True" Enable="true" Width="40px" BorderStyle="none" Height="auto">
                                    <Format HAlign="Left"/>
                                    <OnClick>
                                        <![CDATA[
										if(Material_code==''){
											return true;
										}
										var count=GetRowCount('list');
										var i=0;
										var flag=false;
										while(i<count){
											if(GetCellValue('list',i,'Materialcode')==Material_code){
												SetFocusRow('list',i);
												SetRowIndex('list',i);
												ScrollTo('list',i);
												flag=true;
												break;
											}
											i=i+1;
										}
										if(flag==false){
											ShowToast("移位明细中找不到该条码物料。");
										}
										]]>
                                    </OnClick>
                                </Button>
                                <ComboBox Caption="状态" Enable="false" Key="Status" SourceType="Status" Visible="false">
                                    <DataBinding ColumnKey="Status" TableKey="LRP_WMTx_H"/>
                                </ComboBox>
                                <DatePicker Key="FinishDateTime" Caption="移位完成日期" Visible="false" Format="yyyy-MM-dd">
                                    <DataBinding ColumnKey="FinishDateTime" TableKey="LRP_WMTx_H"/>
                                </DatePicker>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r2" SeparatorStyle="solid solid solid none" SeparatorColor="#dde0e7" BottomMargin="20px">
                            <LinearLayoutPanel Key="Srcservice_center_panel" Height="50px" Orientation="Horizontal">
                                <TextEditor Key="SrcLocation_code" Caption="扫描源储位" PromptText="扫描源储位" Weight="1.0" Width="auto" BorderRadius="4" BorderColor="#dde0e7" HasBorder="true" Enable="True" Height="auto">
                                    <KeyEnter>
                                        <![CDATA[
										if(SrcLocation_code==''){
											return true;
										}
										var count=GetRowCount('list');
										var i=0;
										var flag=false;
										while(i<count){
											if(GetCellValue('list',i,'SrcLocationCode')==SrcLocation_code){
												SetFocusRow('list',i);
												SetRowIndex('list',i);
												ScrollTo('list',i);
												flag=true;
												break;
											}
											i=i+1;
										}
										if(flag==false){
											ShowToast("移位明细中找不到该代码的源储位。");
										}
										SetFocus('SrcLocation_code');
									  ]]>
                                    </KeyEnter>
                                </TextEditor>
                                <Button Key="Srcquery_btn1" Icon="12.png" OnlyIcon="True" Enable="true" Width="40px" BorderStyle="none" Height="auto">
                                    <Format HAlign="Left"/>
                                    <OnClick>
                                        <![CDATA[
										if(SrcLocation_code==''){
											return true;
										}
										var count=GetRowCount('list');
										var i=0;
										var flag=false;
										while(i<count){
											if(GetCellValue('list',i,'SrcLocationCode')==SrcLocation_code){
												SetFocusRow('list',i);
												SetRowIndex('list',i);
												ScrollTo('list',i);
												flag=true;
												break;
											}
											i=i+1;
										}
										if(flag==false){
											ShowToast("移位明细中找不到该代码的源储位。");
										}
									]]>
                                    </OnClick>
                                </Button>
                            </LinearLayoutPanel>
                        </TableRow>
                        <TableRow Key="r3" SeparatorStyle="solid solid solid none" SeparatorColor="#dde0e7" BottomMargin="20px">
                            <LinearLayoutPanel Key="Destservice_center_panel" Height="50px" Orientation="Horizontal">
                                <TextEditor Key="DestLocation_code" Caption="扫描目标储位" PromptText="扫描目标储位" Weight="1.0" Width="auto" BorderRadius="4" BorderColor="#dde0e7" HasBorder="true" Enable="True" Height="auto">
                                    <KeyEnter>
                                        <![CDATA[
										if(DestLocation_code==''){
											return true;
										}
										var count=GetRowCount('list');
										var i=0;
										var flag=false;
										while(i<count){
											if(GetCellValue('list',i,'DestLocationCode')==DestLocation_code){
												SetFocusRow('list',i);
												SetRowIndex('list',i);
												ScrollTo('list',i);
												flag=true;
												break;
											}
											i=i+1;
										}
										if(flag==false){
											ShowToast("移位明细中找不到该代码的目标储位。");
										}
										SetFocus('DestLocation_code');
									  ]]>
                                    </KeyEnter>
                                </TextEditor>
                                <Button Key="Destquery_btn1" Icon="12.png" OnlyIcon="True" Enable="true" Width="40px" BorderStyle="none" Height="auto">
                                    <Format HAlign="Left"/>
                                    <OnClick>
                                        <![CDATA[
										if(DestLocation_code==''){
											return true;
										}
										var count=GetRowCount('list');
										var i=0;
										var flag=false;
										while(i<count){
											if(GetCellValue('list',i,'DestLocationCode')==DestLocation_code){
												SetFocusRow('list',i);
												SetRowIndex('list',i);
												ScrollTo('list',i);
												flag=true;
												break;
											}
											i=i+1;
										}
										if(flag==false){
											ShowToast("移位明细中找不到该代码的目标储位。");
										}
									]]>
                                    </OnClick>
                                </Button>
                            </LinearLayoutPanel>
                        </TableRow>
                    </TableRowCollection>
                </TableView>
                <TableView Key="locationdetail_table" X="0" Y="2">
                    <Format BackColor="#f1f3f8"/>
                    <TableRowCollection>
                        <TableRow Key="list" SeparatorStyle="solid none solid none" RowType="Detail" SeparatorColor="#dde0e7" TableKey="LRP_WMTx_L" SelectColor="#dddddd">
                            <GridLayoutPanel Key="GridLayoutPanel" Caption="GridLayoutPanel">
                                <Dict Key="MaterialId" X="0" Y="0" Visible="false" ItemKey="LRP_Material">
                                    <DataBinding ColumnKey="MaterialId"/>
                                </Dict>
                                <ComboBox Caption="状态" Key="Status_L" SourceType="Status" Visible="false" X="0" Y="0">
                                    <DataBinding ColumnKey="Status"/>
                                </ComboBox>
                                <Label Key="Materialcode" LeftPadding="5px" X="0" Y="0" XSpan="4">
                                    <DataBinding DefaultFormulaValue="GetDictValue('LRP_Material',MaterialId,'LRP_Material.Code')"/>
                                </Label>
                                <Label Key="MaterialName" LeftPadding="5px" X="4" Y="0" XSpan="6">
                                    <DataBinding DefaultFormulaValue="GetDictValue('LRP_Material',MaterialId,'LRP_Material.Name')"/>
                                </Label>
                                <Label Key="SrcBatchNo_lbl" Caption="批号" LeftPadding="5px" X="10" Y="0" XSpan="2"/>
                                <Label Key="SrcBatchNo" X="12" Y="0" XSpan="2">
                                    <DataBinding ColumnKey="SrcBatchNo"/>
                                </Label>
                                <Dict Key="SrcLocationId" X="0" Y="0" Visible="false" ItemKey="LRP_Location">
                                    <DataBinding ColumnKey="SrcLocationId"/>
                                </Dict>
                                <Label Key="SrcLocationCode_lbl" Caption="源" LeftPadding="5px" X="0" Y="1" XSpan="2"/>
                                <Label Key="SrcLocationCode" LeftPadding="5px" X="2" Y="1" XSpan="2">
                                    <DataBinding DefaultFormulaValue="GetDictValue('LRP_Location',SrcLocationId,'LRP_Location.Code')"/>
                                </Label>
                                <Label Key="Qty_lbl" Caption="数量" LeftPadding="5px" X="4" Y="1" XSpan="2"/>
                                <NumberEditor Key="Qty" Precision="18" Scale="0" X="6" Y="1" XSpan="2">
                                    <DataBinding ColumnKey="Qty"/>
                                </NumberEditor>
                                <Label Key="BasicUnit" LeftPadding="5px" X="8" Y="1" XSpan="2">
                                    <DataBinding ColumnKey="MaterialUnit"/>
                                </Label>
                                <Dict Key="DestLocationId" X="0" Y="0" Visible="false" ItemKey="LRP_Location">
                                    <DataBinding ColumnKey="DestLocationId"/>
                                </Dict>
                                <Label Key="DestLocationCode_lbl" Caption="目标" LeftPadding="5px" X="10" Y="1" XSpan="2"/>
                                <Label Key="DestLocationCode" LeftPadding="5px" X="12" Y="1" XSpan="2">
                                    <DataBinding DefaultFormulaValue="GetDictValue('LRP_Location',DestLocationId,'LRP_Location.Code')"/>
                                </Label>
                                <RowDefCollection RowGap="1">
                                    <RowDef Height="30px"/>
                                    <RowDef Height="40px"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="1">
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="15%"/>
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="15%"/>
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="14%"/>
                                    <ColumnDef Width="30px"/>
                                    <ColumnDef Width="14%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                        </TableRow>
                    </TableRowCollection>
                </TableView>
                <RowDefCollection>
                    <RowDef Height="50px"/>
                    <RowDef Height="210px"/>
                    <RowDef Height="100%"/>
                </RowDefCollection>
                <ColumnDefCollection>
                    <ColumnDef Width="100%"/>
                </ColumnDefCollection>
            </GridLayoutPanel>
        </Block>
    </Body>
    <OnLoad>
        <![CDATA[
			LoadData();
        ]]>
    </OnLoad>
</Form>
